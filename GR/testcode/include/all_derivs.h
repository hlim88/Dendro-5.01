        gtd(1,1) = gtxx(i,j,k)
        d_gtd(1,1,1) = (
     & + gtxx(i-2,j,k)*(0.0833333333333333d0)
     & + gtxx(i-1,j,k)*(-0.666666666666667d0)
     & + gtxx(i+1,j,k)*(0.666666666666667d0)
     & + gtxx(i+2,j,k)*(-0.0833333333333333d0)
     & )*idx
        d_gtd(2,1,1) = (
     & + gtxx(i,j-2,k)*(0.0833333333333333d0)
     & + gtxx(i,j-1,k)*(-0.666666666666667d0)
     & + gtxx(i,j+1,k)*(0.666666666666667d0)
     & + gtxx(i,j+2,k)*(-0.0833333333333333d0)
     & )*idx
        d_gtd(3,1,1) = (
     & + gtxx(i,j,k-2)*(0.0833333333333333d0)
     & + gtxx(i,j,k-1)*(-0.666666666666667d0)
     & + gtxx(i,j,k+1)*(0.666666666666667d0)
     & + gtxx(i,j,k+2)*(-0.0833333333333333d0)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_gtd(1,1,1) = (
     & + gtxx(i-1,j,k)*(-0.25d0)
     & + gtxx(i,j,k)*(-0.833333333333333d0)
     & + gtxx(i+1,j,k)*(1.5d0)
     & + gtxx(i+2,j,k)*(-0.5d0)
     & + gtxx(i+3,j,k)*(0.0833333333333333d0)
     & )*idx
        else
        adv_d_gtd(1,1,1) = (
     & + gtxx(i-3,j,k)*(-0.0833333333333333d0)
     & + gtxx(i-2,j,k)*(0.5d0)
     & + gtxx(i-1,j,k)*(-1.5d0)
     & + gtxx(i  ,j,k)*(0.833333333333333d0)
     & + gtxx(i+1,j,k)*(0.25d0)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_gtd(2,1,1) = (
     & + gtxx(i,j-1,k)*(-0.25)
     & + gtxx(i,j  ,k)*(-0.833333333333333)
     & + gtxx(i,j+1,k)*(1.5)
     & + gtxx(i,j+2,k)*(-0.5)
     & + gtxx(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_gtd(2,1,1) = (
     & + gtxx(i,j-3,k)*(-0.0833333333333333)
     & + gtxx(i,j-2,k)*(0.5)
     & + gtxx(i,j-1,k)*(-1.5)
     & + gtxx(i,j  ,k)*(0.833333333333333)
     & + gtxx(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_gtd(3,1,1) = (
     & + gtxx(i,j,k-1)*(-0.25)
     & + gtxx(i,j,k)*(-0.833333333333333)
     & + gtxx(i,j,k+1)*(1.5)
     & + gtxx(i,j,k+2)*(-0.5)
     & + gtxx(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_gtd(3,1,1) = (
     & + gtxx(i,j,k-3)*(-0.0833333333333333)
     & + gtxx(i,j,k-2)*(0.5)
     & + gtxx(i,j,k-1)*(-1.5)
     & + gtxx(i,j,k)*(0.833333333333333)
     & + gtxx(i,j,k+1)*(0.25)
     & )*idx
        end if
        dd_gtd(1,1,1,1) = (
     & + gtxx(i-2,j,k)*(-0.0833333333333333)
     & + gtxx(i-1,j,k)*(1.33333333333333)
     & + gtxx(i,j,k)*(-2.5)
     & + gtxx(i+1,j,k)*(1.33333333333333)
     & + gtxx(i+2,j,k)*(-0.0833333333333333)
     & )*idxsq
        dd_gtd(2,2,1,1) = (
     & + gtxx(i,j-2,k)*(-0.0833333333333333)
     & + gtxx(i,j-1,k)*(1.33333333333333)
     & + gtxx(i,j,k)*(-2.5)
     & + gtxx(i,j+1,k)*(1.33333333333333)
     & + gtxx(i,j+2,k)*(-0.0833333333333333)
     & )*idxsq
        dd_gtd(3,3,1,1) = (
     & + gtxx(i,j,k-2)*(-0.0833333333333333)
     & + gtxx(i,j,k-1)*(1.33333333333333)
     & + gtxx(i,j,k)*(-2.5)
     & + gtxx(i,j,k+1)*(1.33333333333333)
     & + gtxx(i,j,k+2)*(-0.0833333333333333)
     & )*idxsq
        dd_gtd(1,2,1,1) = (
     & + gtxx(i-2,j-2,k)*(0.00694444444444444)
     & + gtxx(i-2,j-1,k)*(-0.0555555555555556)
     & + gtxx(i-2,j+1,k)*(0.0555555555555556)
     & + gtxx(i-2,j+2,k)*(-0.00694444444444444)
     & + gtxx(i-1,j-2,k)*(-0.0555555555555556)
     & + gtxx(i-1,j-1,k)*(0.444444444444444)
     & + gtxx(i-1,j+1,k)*(-0.444444444444444)
     & + gtxx(i-1,j+2,k)*(0.0555555555555556)
     & + gtxx(i+1,j-2,k)*(0.0555555555555556)
     & + gtxx(i+1,j-1,k)*(-0.444444444444444)
     & + gtxx(i+1,j+1,k)*(0.444444444444444)
     & + gtxx(i+1,j+2,k)*(-0.0555555555555556)
     & + gtxx(i+2,j-2,k)*(-0.00694444444444444)
     & + gtxx(i+2,j-1,k)*(0.0555555555555556)
     & + gtxx(i+2,j+1,k)*(-0.0555555555555556)
     & + gtxx(i+2,j+2,k)*(0.00694444444444444)
     & )*idxsq
        dd_gtd(1,3,1,1) = (
     & + gtxx(i-2,j,k-2)*(0.00694444444444444)
     & + gtxx(i-2,j,k-1)*(-0.0555555555555556)
     & + gtxx(i-2,j,k+1)*(0.0555555555555556)
     & + gtxx(i-2,j,k+2)*(-0.00694444444444444)
     & + gtxx(i-1,j,k-2)*(-0.0555555555555556)
     & + gtxx(i-1,j,k-1)*(0.444444444444444)
     & + gtxx(i-1,j,k+1)*(-0.444444444444444)
     & + gtxx(i-1,j,k+2)*(0.0555555555555556)
     & + gtxx(i+1,j,k-2)*(0.0555555555555556)
     & + gtxx(i+1,j,k-1)*(-0.444444444444444)
     & + gtxx(i+1,j,k+1)*(0.444444444444444)
     & + gtxx(i+1,j,k+2)*(-0.0555555555555556)
     & + gtxx(i+2,j,k-2)*(-0.00694444444444444)
     & + gtxx(i+2,j,k-1)*(0.0555555555555556)
     & + gtxx(i+2,j,k+1)*(-0.0555555555555556)
     & + gtxx(i+2,j,k+2)*(0.00694444444444444)
     & )*idxsq
        dd_gtd(2,3,1,1) = (
     & + gtxx(i,j-2,k-2)*(0.00694444444444444)
     & + gtxx(i,j-2,k-1)*(-0.0555555555555556)
     & + gtxx(i,j-2,k+1)*(0.0555555555555556)
     & + gtxx(i,j-2,k+2)*(-0.00694444444444444)
     & + gtxx(i,j-1,k-2)*(-0.0555555555555556)
     & + gtxx(i,j-1,k-1)*(0.444444444444444)
     & + gtxx(i,j-1,k+1)*(-0.444444444444444)
     & + gtxx(i,j-1,k+2)*(0.0555555555555556)
     & + gtxx(i,j+1,k-2)*(0.0555555555555556)
     & + gtxx(i,j+1,k-1)*(-0.444444444444444)
     & + gtxx(i,j+1,k+1)*(0.444444444444444)
     & + gtxx(i,j+1,k+2)*(-0.0555555555555556)
     & + gtxx(i,j+2,k-2)*(-0.00694444444444444)
     & + gtxx(i,j+2,k-1)*(0.0555555555555556)
     & + gtxx(i,j+2,k+1)*(-0.0555555555555556)
     & + gtxx(i,j+2,k+2)*(0.00694444444444444)
     & )*idxsq
        gtd(1,2) = gtxy(i,j,k)
        d_gtd(1,1,2) = (
     & + gtxy(i-2,j,k)*(0.0833333333333333d0)
     & + gtxy(i-1,j,k)*(-0.666666666666667d0)
     & + gtxy(i+1,j,k)*(0.666666666666667d0)
     & + gtxy(i+2,j,k)*(-0.0833333333333333d0)
     & )*idx
        d_gtd(2,1,2) = (
     & + gtxy(i,j-2,k)*(0.0833333333333333d0)
     & + gtxy(i,j-1,k)*(-0.666666666666667d0)
     & + gtxy(i,j+1,k)*(0.666666666666667d0)
     & + gtxy(i,j+2,k)*(-0.0833333333333333d0)
     & )*idx
        d_gtd(3,1,2) = (
     & + gtxy(i,j,k-2)*(0.0833333333333333d0)
     & + gtxy(i,j,k-1)*(-0.666666666666667d0)
     & + gtxy(i,j,k+1)*(0.666666666666667d0)
     & + gtxy(i,j,k+2)*(-0.0833333333333333d0)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_gtd(1,1,2) = (
     & + gtxy(i-1,j,k)*(-0.25d0)
     & + gtxy(i,j,k)*(-0.833333333333333d0)
     & + gtxy(i+1,j,k)*(1.5d0)
     & + gtxy(i+2,j,k)*(-0.5d0)
     & + gtxy(i+3,j,k)*(0.0833333333333333d0)
     & )*idx
        else
        adv_d_gtd(1,1,2) = (
     & + gtxy(i-3,j,k)*(-0.0833333333333333d0)
     & + gtxy(i-2,j,k)*(0.5d0)
     & + gtxy(i-1,j,k)*(-1.5d0)
     & + gtxy(i  ,j,k)*(0.833333333333333d0)
     & + gtxy(i+1,j,k)*(0.25d0)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_gtd(2,1,2) = (
     & + gtxy(i,j-1,k)*(-0.25)
     & + gtxy(i,j  ,k)*(-0.833333333333333)
     & + gtxy(i,j+1,k)*(1.5)
     & + gtxy(i,j+2,k)*(-0.5)
     & + gtxy(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_gtd(2,1,2) = (
     & + gtxy(i,j-3,k)*(-0.0833333333333333)
     & + gtxy(i,j-2,k)*(0.5)
     & + gtxy(i,j-1,k)*(-1.5)
     & + gtxy(i,j  ,k)*(0.833333333333333)
     & + gtxy(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_gtd(3,1,2) = (
     & + gtxy(i,j,k-1)*(-0.25)
     & + gtxy(i,j,k)*(-0.833333333333333)
     & + gtxy(i,j,k+1)*(1.5)
     & + gtxy(i,j,k+2)*(-0.5)
     & + gtxy(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_gtd(3,1,2) = (
     & + gtxy(i,j,k-3)*(-0.0833333333333333)
     & + gtxy(i,j,k-2)*(0.5)
     & + gtxy(i,j,k-1)*(-1.5)
     & + gtxy(i,j,k)*(0.833333333333333)
     & + gtxy(i,j,k+1)*(0.25)
     & )*idx
        end if
        dd_gtd(1,1,1,2) = (
     & + gtxy(i-2,j,k)*(-0.0833333333333333)
     & + gtxy(i-1,j,k)*(1.33333333333333)
     & + gtxy(i,j,k)*(-2.5)
     & + gtxy(i+1,j,k)*(1.33333333333333)
     & + gtxy(i+2,j,k)*(-0.0833333333333333)
     & )*idxsq
        dd_gtd(2,2,1,2) = (
     & + gtxy(i,j-2,k)*(-0.0833333333333333)
     & + gtxy(i,j-1,k)*(1.33333333333333)
     & + gtxy(i,j,k)*(-2.5)
     & + gtxy(i,j+1,k)*(1.33333333333333)
     & + gtxy(i,j+2,k)*(-0.0833333333333333)
     & )*idxsq
        dd_gtd(3,3,1,2) = (
     & + gtxy(i,j,k-2)*(-0.0833333333333333)
     & + gtxy(i,j,k-1)*(1.33333333333333)
     & + gtxy(i,j,k)*(-2.5)
     & + gtxy(i,j,k+1)*(1.33333333333333)
     & + gtxy(i,j,k+2)*(-0.0833333333333333)
     & )*idxsq
        dd_gtd(1,2,1,2) = (
     & + gtxy(i-2,j-2,k)*(0.00694444444444444)
     & + gtxy(i-2,j-1,k)*(-0.0555555555555556)
     & + gtxy(i-2,j+1,k)*(0.0555555555555556)
     & + gtxy(i-2,j+2,k)*(-0.00694444444444444)
     & + gtxy(i-1,j-2,k)*(-0.0555555555555556)
     & + gtxy(i-1,j-1,k)*(0.444444444444444)
     & + gtxy(i-1,j+1,k)*(-0.444444444444444)
     & + gtxy(i-1,j+2,k)*(0.0555555555555556)
     & + gtxy(i+1,j-2,k)*(0.0555555555555556)
     & + gtxy(i+1,j-1,k)*(-0.444444444444444)
     & + gtxy(i+1,j+1,k)*(0.444444444444444)
     & + gtxy(i+1,j+2,k)*(-0.0555555555555556)
     & + gtxy(i+2,j-2,k)*(-0.00694444444444444)
     & + gtxy(i+2,j-1,k)*(0.0555555555555556)
     & + gtxy(i+2,j+1,k)*(-0.0555555555555556)
     & + gtxy(i+2,j+2,k)*(0.00694444444444444)
     & )*idxsq
        dd_gtd(1,3,1,2) = (
     & + gtxy(i-2,j,k-2)*(0.00694444444444444)
     & + gtxy(i-2,j,k-1)*(-0.0555555555555556)
     & + gtxy(i-2,j,k+1)*(0.0555555555555556)
     & + gtxy(i-2,j,k+2)*(-0.00694444444444444)
     & + gtxy(i-1,j,k-2)*(-0.0555555555555556)
     & + gtxy(i-1,j,k-1)*(0.444444444444444)
     & + gtxy(i-1,j,k+1)*(-0.444444444444444)
     & + gtxy(i-1,j,k+2)*(0.0555555555555556)
     & + gtxy(i+1,j,k-2)*(0.0555555555555556)
     & + gtxy(i+1,j,k-1)*(-0.444444444444444)
     & + gtxy(i+1,j,k+1)*(0.444444444444444)
     & + gtxy(i+1,j,k+2)*(-0.0555555555555556)
     & + gtxy(i+2,j,k-2)*(-0.00694444444444444)
     & + gtxy(i+2,j,k-1)*(0.0555555555555556)
     & + gtxy(i+2,j,k+1)*(-0.0555555555555556)
     & + gtxy(i+2,j,k+2)*(0.00694444444444444)
     & )*idxsq
        dd_gtd(2,3,1,2) = (
     & + gtxy(i,j-2,k-2)*(0.00694444444444444)
     & + gtxy(i,j-2,k-1)*(-0.0555555555555556)
     & + gtxy(i,j-2,k+1)*(0.0555555555555556)
     & + gtxy(i,j-2,k+2)*(-0.00694444444444444)
     & + gtxy(i,j-1,k-2)*(-0.0555555555555556)
     & + gtxy(i,j-1,k-1)*(0.444444444444444)
     & + gtxy(i,j-1,k+1)*(-0.444444444444444)
     & + gtxy(i,j-1,k+2)*(0.0555555555555556)
     & + gtxy(i,j+1,k-2)*(0.0555555555555556)
     & + gtxy(i,j+1,k-1)*(-0.444444444444444)
     & + gtxy(i,j+1,k+1)*(0.444444444444444)
     & + gtxy(i,j+1,k+2)*(-0.0555555555555556)
     & + gtxy(i,j+2,k-2)*(-0.00694444444444444)
     & + gtxy(i,j+2,k-1)*(0.0555555555555556)
     & + gtxy(i,j+2,k+1)*(-0.0555555555555556)
     & + gtxy(i,j+2,k+2)*(0.00694444444444444)
     & )*idxsq
        gtd(1,3) = gtxz(i,j,k)
        d_gtd(1,1,3) = (
     & + gtxz(i-2,j,k)*(0.0833333333333333d0)
     & + gtxz(i-1,j,k)*(-0.666666666666667d0)
     & + gtxz(i+1,j,k)*(0.666666666666667d0)
     & + gtxz(i+2,j,k)*(-0.0833333333333333d0)
     & )*idx
        d_gtd(2,1,3) = (
     & + gtxz(i,j-2,k)*(0.0833333333333333d0)
     & + gtxz(i,j-1,k)*(-0.666666666666667d0)
     & + gtxz(i,j+1,k)*(0.666666666666667d0)
     & + gtxz(i,j+2,k)*(-0.0833333333333333d0)
     & )*idx
        d_gtd(3,1,3) = (
     & + gtxz(i,j,k-2)*(0.0833333333333333d0)
     & + gtxz(i,j,k-1)*(-0.666666666666667d0)
     & + gtxz(i,j,k+1)*(0.666666666666667d0)
     & + gtxz(i,j,k+2)*(-0.0833333333333333d0)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_gtd(1,1,3) = (
     & + gtxz(i-1,j,k)*(-0.25d0)
     & + gtxz(i,j,k)*(-0.833333333333333d0)
     & + gtxz(i+1,j,k)*(1.5d0)
     & + gtxz(i+2,j,k)*(-0.5d0)
     & + gtxz(i+3,j,k)*(0.0833333333333333d0)
     & )*idx
        else
        adv_d_gtd(1,1,3) = (
     & + gtxz(i-3,j,k)*(-0.0833333333333333d0)
     & + gtxz(i-2,j,k)*(0.5d0)
     & + gtxz(i-1,j,k)*(-1.5d0)
     & + gtxz(i  ,j,k)*(0.833333333333333d0)
     & + gtxz(i+1,j,k)*(0.25d0)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_gtd(2,1,3) = (
     & + gtxz(i,j-1,k)*(-0.25)
     & + gtxz(i,j  ,k)*(-0.833333333333333)
     & + gtxz(i,j+1,k)*(1.5)
     & + gtxz(i,j+2,k)*(-0.5)
     & + gtxz(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_gtd(2,1,3) = (
     & + gtxz(i,j-3,k)*(-0.0833333333333333)
     & + gtxz(i,j-2,k)*(0.5)
     & + gtxz(i,j-1,k)*(-1.5)
     & + gtxz(i,j  ,k)*(0.833333333333333)
     & + gtxz(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_gtd(3,1,3) = (
     & + gtxz(i,j,k-1)*(-0.25)
     & + gtxz(i,j,k)*(-0.833333333333333)
     & + gtxz(i,j,k+1)*(1.5)
     & + gtxz(i,j,k+2)*(-0.5)
     & + gtxz(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_gtd(3,1,3) = (
     & + gtxz(i,j,k-3)*(-0.0833333333333333)
     & + gtxz(i,j,k-2)*(0.5)
     & + gtxz(i,j,k-1)*(-1.5)
     & + gtxz(i,j,k)*(0.833333333333333)
     & + gtxz(i,j,k+1)*(0.25)
     & )*idx
        end if
        dd_gtd(1,1,1,3) = (
     & + gtxz(i-2,j,k)*(-0.0833333333333333)
     & + gtxz(i-1,j,k)*(1.33333333333333)
     & + gtxz(i,j,k)*(-2.5)
     & + gtxz(i+1,j,k)*(1.33333333333333)
     & + gtxz(i+2,j,k)*(-0.0833333333333333)
     & )*idxsq
        dd_gtd(2,2,1,3) = (
     & + gtxz(i,j-2,k)*(-0.0833333333333333)
     & + gtxz(i,j-1,k)*(1.33333333333333)
     & + gtxz(i,j,k)*(-2.5)
     & + gtxz(i,j+1,k)*(1.33333333333333)
     & + gtxz(i,j+2,k)*(-0.0833333333333333)
     & )*idxsq
        dd_gtd(3,3,1,3) = (
     & + gtxz(i,j,k-2)*(-0.0833333333333333)
     & + gtxz(i,j,k-1)*(1.33333333333333)
     & + gtxz(i,j,k)*(-2.5)
     & + gtxz(i,j,k+1)*(1.33333333333333)
     & + gtxz(i,j,k+2)*(-0.0833333333333333)
     & )*idxsq
        dd_gtd(1,2,1,3) = (
     & + gtxz(i-2,j-2,k)*(0.00694444444444444)
     & + gtxz(i-2,j-1,k)*(-0.0555555555555556)
     & + gtxz(i-2,j+1,k)*(0.0555555555555556)
     & + gtxz(i-2,j+2,k)*(-0.00694444444444444)
     & + gtxz(i-1,j-2,k)*(-0.0555555555555556)
     & + gtxz(i-1,j-1,k)*(0.444444444444444)
     & + gtxz(i-1,j+1,k)*(-0.444444444444444)
     & + gtxz(i-1,j+2,k)*(0.0555555555555556)
     & + gtxz(i+1,j-2,k)*(0.0555555555555556)
     & + gtxz(i+1,j-1,k)*(-0.444444444444444)
     & + gtxz(i+1,j+1,k)*(0.444444444444444)
     & + gtxz(i+1,j+2,k)*(-0.0555555555555556)
     & + gtxz(i+2,j-2,k)*(-0.00694444444444444)
     & + gtxz(i+2,j-1,k)*(0.0555555555555556)
     & + gtxz(i+2,j+1,k)*(-0.0555555555555556)
     & + gtxz(i+2,j+2,k)*(0.00694444444444444)
     & )*idxsq
        dd_gtd(1,3,1,3) = (
     & + gtxz(i-2,j,k-2)*(0.00694444444444444)
     & + gtxz(i-2,j,k-1)*(-0.0555555555555556)
     & + gtxz(i-2,j,k+1)*(0.0555555555555556)
     & + gtxz(i-2,j,k+2)*(-0.00694444444444444)
     & + gtxz(i-1,j,k-2)*(-0.0555555555555556)
     & + gtxz(i-1,j,k-1)*(0.444444444444444)
     & + gtxz(i-1,j,k+1)*(-0.444444444444444)
     & + gtxz(i-1,j,k+2)*(0.0555555555555556)
     & + gtxz(i+1,j,k-2)*(0.0555555555555556)
     & + gtxz(i+1,j,k-1)*(-0.444444444444444)
     & + gtxz(i+1,j,k+1)*(0.444444444444444)
     & + gtxz(i+1,j,k+2)*(-0.0555555555555556)
     & + gtxz(i+2,j,k-2)*(-0.00694444444444444)
     & + gtxz(i+2,j,k-1)*(0.0555555555555556)
     & + gtxz(i+2,j,k+1)*(-0.0555555555555556)
     & + gtxz(i+2,j,k+2)*(0.00694444444444444)
     & )*idxsq
        dd_gtd(2,3,1,3) = (
     & + gtxz(i,j-2,k-2)*(0.00694444444444444)
     & + gtxz(i,j-2,k-1)*(-0.0555555555555556)
     & + gtxz(i,j-2,k+1)*(0.0555555555555556)
     & + gtxz(i,j-2,k+2)*(-0.00694444444444444)
     & + gtxz(i,j-1,k-2)*(-0.0555555555555556)
     & + gtxz(i,j-1,k-1)*(0.444444444444444)
     & + gtxz(i,j-1,k+1)*(-0.444444444444444)
     & + gtxz(i,j-1,k+2)*(0.0555555555555556)
     & + gtxz(i,j+1,k-2)*(0.0555555555555556)
     & + gtxz(i,j+1,k-1)*(-0.444444444444444)
     & + gtxz(i,j+1,k+1)*(0.444444444444444)
     & + gtxz(i,j+1,k+2)*(-0.0555555555555556)
     & + gtxz(i,j+2,k-2)*(-0.00694444444444444)
     & + gtxz(i,j+2,k-1)*(0.0555555555555556)
     & + gtxz(i,j+2,k+1)*(-0.0555555555555556)
     & + gtxz(i,j+2,k+2)*(0.00694444444444444)
     & )*idxsq
        gtd(2,2) = gtyy(i,j,k)
        d_gtd(1,2,2) = (
     & + gtyy(i-2,j,k)*(0.0833333333333333d0)
     & + gtyy(i-1,j,k)*(-0.666666666666667d0)
     & + gtyy(i+1,j,k)*(0.666666666666667d0)
     & + gtyy(i+2,j,k)*(-0.0833333333333333d0)
     & )*idx
        d_gtd(2,2,2) = (
     & + gtyy(i,j-2,k)*(0.0833333333333333d0)
     & + gtyy(i,j-1,k)*(-0.666666666666667d0)
     & + gtyy(i,j+1,k)*(0.666666666666667d0)
     & + gtyy(i,j+2,k)*(-0.0833333333333333d0)
     & )*idx
        d_gtd(3,2,2) = (
     & + gtyy(i,j,k-2)*(0.0833333333333333d0)
     & + gtyy(i,j,k-1)*(-0.666666666666667d0)
     & + gtyy(i,j,k+1)*(0.666666666666667d0)
     & + gtyy(i,j,k+2)*(-0.0833333333333333d0)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_gtd(1,2,2) = (
     & + gtyy(i-1,j,k)*(-0.25d0)
     & + gtyy(i,j,k)*(-0.833333333333333d0)
     & + gtyy(i+1,j,k)*(1.5d0)
     & + gtyy(i+2,j,k)*(-0.5d0)
     & + gtyy(i+3,j,k)*(0.0833333333333333d0)
     & )*idx
        else
        adv_d_gtd(1,2,2) = (
     & + gtyy(i-3,j,k)*(-0.0833333333333333d0)
     & + gtyy(i-2,j,k)*(0.5d0)
     & + gtyy(i-1,j,k)*(-1.5d0)
     & + gtyy(i  ,j,k)*(0.833333333333333d0)
     & + gtyy(i+1,j,k)*(0.25d0)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_gtd(2,2,2) = (
     & + gtyy(i,j-1,k)*(-0.25)
     & + gtyy(i,j  ,k)*(-0.833333333333333)
     & + gtyy(i,j+1,k)*(1.5)
     & + gtyy(i,j+2,k)*(-0.5)
     & + gtyy(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_gtd(2,2,2) = (
     & + gtyy(i,j-3,k)*(-0.0833333333333333)
     & + gtyy(i,j-2,k)*(0.5)
     & + gtyy(i,j-1,k)*(-1.5)
     & + gtyy(i,j  ,k)*(0.833333333333333)
     & + gtyy(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_gtd(3,2,2) = (
     & + gtyy(i,j,k-1)*(-0.25)
     & + gtyy(i,j,k)*(-0.833333333333333)
     & + gtyy(i,j,k+1)*(1.5)
     & + gtyy(i,j,k+2)*(-0.5)
     & + gtyy(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_gtd(3,2,2) = (
     & + gtyy(i,j,k-3)*(-0.0833333333333333)
     & + gtyy(i,j,k-2)*(0.5)
     & + gtyy(i,j,k-1)*(-1.5)
     & + gtyy(i,j,k)*(0.833333333333333)
     & + gtyy(i,j,k+1)*(0.25)
     & )*idx
        end if
        dd_gtd(1,1,2,2) = (
     & + gtyy(i-2,j,k)*(-0.0833333333333333)
     & + gtyy(i-1,j,k)*(1.33333333333333)
     & + gtyy(i,j,k)*(-2.5)
     & + gtyy(i+1,j,k)*(1.33333333333333)
     & + gtyy(i+2,j,k)*(-0.0833333333333333)
     & )*idxsq
        dd_gtd(2,2,2,2) = (
     & + gtyy(i,j-2,k)*(-0.0833333333333333)
     & + gtyy(i,j-1,k)*(1.33333333333333)
     & + gtyy(i,j,k)*(-2.5)
     & + gtyy(i,j+1,k)*(1.33333333333333)
     & + gtyy(i,j+2,k)*(-0.0833333333333333)
     & )*idxsq
        dd_gtd(3,3,2,2) = (
     & + gtyy(i,j,k-2)*(-0.0833333333333333)
     & + gtyy(i,j,k-1)*(1.33333333333333)
     & + gtyy(i,j,k)*(-2.5)
     & + gtyy(i,j,k+1)*(1.33333333333333)
     & + gtyy(i,j,k+2)*(-0.0833333333333333)
     & )*idxsq
        dd_gtd(1,2,2,2) = (
     & + gtyy(i-2,j-2,k)*(0.00694444444444444)
     & + gtyy(i-2,j-1,k)*(-0.0555555555555556)
     & + gtyy(i-2,j+1,k)*(0.0555555555555556)
     & + gtyy(i-2,j+2,k)*(-0.00694444444444444)
     & + gtyy(i-1,j-2,k)*(-0.0555555555555556)
     & + gtyy(i-1,j-1,k)*(0.444444444444444)
     & + gtyy(i-1,j+1,k)*(-0.444444444444444)
     & + gtyy(i-1,j+2,k)*(0.0555555555555556)
     & + gtyy(i+1,j-2,k)*(0.0555555555555556)
     & + gtyy(i+1,j-1,k)*(-0.444444444444444)
     & + gtyy(i+1,j+1,k)*(0.444444444444444)
     & + gtyy(i+1,j+2,k)*(-0.0555555555555556)
     & + gtyy(i+2,j-2,k)*(-0.00694444444444444)
     & + gtyy(i+2,j-1,k)*(0.0555555555555556)
     & + gtyy(i+2,j+1,k)*(-0.0555555555555556)
     & + gtyy(i+2,j+2,k)*(0.00694444444444444)
     & )*idxsq
        dd_gtd(1,3,2,2) = (
     & + gtyy(i-2,j,k-2)*(0.00694444444444444)
     & + gtyy(i-2,j,k-1)*(-0.0555555555555556)
     & + gtyy(i-2,j,k+1)*(0.0555555555555556)
     & + gtyy(i-2,j,k+2)*(-0.00694444444444444)
     & + gtyy(i-1,j,k-2)*(-0.0555555555555556)
     & + gtyy(i-1,j,k-1)*(0.444444444444444)
     & + gtyy(i-1,j,k+1)*(-0.444444444444444)
     & + gtyy(i-1,j,k+2)*(0.0555555555555556)
     & + gtyy(i+1,j,k-2)*(0.0555555555555556)
     & + gtyy(i+1,j,k-1)*(-0.444444444444444)
     & + gtyy(i+1,j,k+1)*(0.444444444444444)
     & + gtyy(i+1,j,k+2)*(-0.0555555555555556)
     & + gtyy(i+2,j,k-2)*(-0.00694444444444444)
     & + gtyy(i+2,j,k-1)*(0.0555555555555556)
     & + gtyy(i+2,j,k+1)*(-0.0555555555555556)
     & + gtyy(i+2,j,k+2)*(0.00694444444444444)
     & )*idxsq
        dd_gtd(2,3,2,2) = (
     & + gtyy(i,j-2,k-2)*(0.00694444444444444)
     & + gtyy(i,j-2,k-1)*(-0.0555555555555556)
     & + gtyy(i,j-2,k+1)*(0.0555555555555556)
     & + gtyy(i,j-2,k+2)*(-0.00694444444444444)
     & + gtyy(i,j-1,k-2)*(-0.0555555555555556)
     & + gtyy(i,j-1,k-1)*(0.444444444444444)
     & + gtyy(i,j-1,k+1)*(-0.444444444444444)
     & + gtyy(i,j-1,k+2)*(0.0555555555555556)
     & + gtyy(i,j+1,k-2)*(0.0555555555555556)
     & + gtyy(i,j+1,k-1)*(-0.444444444444444)
     & + gtyy(i,j+1,k+1)*(0.444444444444444)
     & + gtyy(i,j+1,k+2)*(-0.0555555555555556)
     & + gtyy(i,j+2,k-2)*(-0.00694444444444444)
     & + gtyy(i,j+2,k-1)*(0.0555555555555556)
     & + gtyy(i,j+2,k+1)*(-0.0555555555555556)
     & + gtyy(i,j+2,k+2)*(0.00694444444444444)
     & )*idxsq
        gtd(2,3) = gtyz(i,j,k)
        d_gtd(1,2,3) = (
     & + gtyz(i-2,j,k)*(0.0833333333333333d0)
     & + gtyz(i-1,j,k)*(-0.666666666666667d0)
     & + gtyz(i+1,j,k)*(0.666666666666667d0)
     & + gtyz(i+2,j,k)*(-0.0833333333333333d0)
     & )*idx
        d_gtd(2,2,3) = (
     & + gtyz(i,j-2,k)*(0.0833333333333333d0)
     & + gtyz(i,j-1,k)*(-0.666666666666667d0)
     & + gtyz(i,j+1,k)*(0.666666666666667d0)
     & + gtyz(i,j+2,k)*(-0.0833333333333333d0)
     & )*idx
        d_gtd(3,2,3) = (
     & + gtyz(i,j,k-2)*(0.0833333333333333d0)
     & + gtyz(i,j,k-1)*(-0.666666666666667d0)
     & + gtyz(i,j,k+1)*(0.666666666666667d0)
     & + gtyz(i,j,k+2)*(-0.0833333333333333d0)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_gtd(1,2,3) = (
     & + gtyz(i-1,j,k)*(-0.25d0)
     & + gtyz(i,j,k)*(-0.833333333333333d0)
     & + gtyz(i+1,j,k)*(1.5d0)
     & + gtyz(i+2,j,k)*(-0.5d0)
     & + gtyz(i+3,j,k)*(0.0833333333333333d0)
     & )*idx
        else
        adv_d_gtd(1,2,3) = (
     & + gtyz(i-3,j,k)*(-0.0833333333333333d0)
     & + gtyz(i-2,j,k)*(0.5d0)
     & + gtyz(i-1,j,k)*(-1.5d0)
     & + gtyz(i  ,j,k)*(0.833333333333333d0)
     & + gtyz(i+1,j,k)*(0.25d0)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_gtd(2,2,3) = (
     & + gtyz(i,j-1,k)*(-0.25)
     & + gtyz(i,j  ,k)*(-0.833333333333333)
     & + gtyz(i,j+1,k)*(1.5)
     & + gtyz(i,j+2,k)*(-0.5)
     & + gtyz(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_gtd(2,2,3) = (
     & + gtyz(i,j-3,k)*(-0.0833333333333333)
     & + gtyz(i,j-2,k)*(0.5)
     & + gtyz(i,j-1,k)*(-1.5)
     & + gtyz(i,j  ,k)*(0.833333333333333)
     & + gtyz(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_gtd(3,2,3) = (
     & + gtyz(i,j,k-1)*(-0.25)
     & + gtyz(i,j,k)*(-0.833333333333333)
     & + gtyz(i,j,k+1)*(1.5)
     & + gtyz(i,j,k+2)*(-0.5)
     & + gtyz(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_gtd(3,2,3) = (
     & + gtyz(i,j,k-3)*(-0.0833333333333333)
     & + gtyz(i,j,k-2)*(0.5)
     & + gtyz(i,j,k-1)*(-1.5)
     & + gtyz(i,j,k)*(0.833333333333333)
     & + gtyz(i,j,k+1)*(0.25)
     & )*idx
        end if
        dd_gtd(1,1,2,3) = (
     & + gtyz(i-2,j,k)*(-0.0833333333333333)
     & + gtyz(i-1,j,k)*(1.33333333333333)
     & + gtyz(i,j,k)*(-2.5)
     & + gtyz(i+1,j,k)*(1.33333333333333)
     & + gtyz(i+2,j,k)*(-0.0833333333333333)
     & )*idxsq
        dd_gtd(2,2,2,3) = (
     & + gtyz(i,j-2,k)*(-0.0833333333333333)
     & + gtyz(i,j-1,k)*(1.33333333333333)
     & + gtyz(i,j,k)*(-2.5)
     & + gtyz(i,j+1,k)*(1.33333333333333)
     & + gtyz(i,j+2,k)*(-0.0833333333333333)
     & )*idxsq
        dd_gtd(3,3,2,3) = (
     & + gtyz(i,j,k-2)*(-0.0833333333333333)
     & + gtyz(i,j,k-1)*(1.33333333333333)
     & + gtyz(i,j,k)*(-2.5)
     & + gtyz(i,j,k+1)*(1.33333333333333)
     & + gtyz(i,j,k+2)*(-0.0833333333333333)
     & )*idxsq
        dd_gtd(1,2,2,3) = (
     & + gtyz(i-2,j-2,k)*(0.00694444444444444)
     & + gtyz(i-2,j-1,k)*(-0.0555555555555556)
     & + gtyz(i-2,j+1,k)*(0.0555555555555556)
     & + gtyz(i-2,j+2,k)*(-0.00694444444444444)
     & + gtyz(i-1,j-2,k)*(-0.0555555555555556)
     & + gtyz(i-1,j-1,k)*(0.444444444444444)
     & + gtyz(i-1,j+1,k)*(-0.444444444444444)
     & + gtyz(i-1,j+2,k)*(0.0555555555555556)
     & + gtyz(i+1,j-2,k)*(0.0555555555555556)
     & + gtyz(i+1,j-1,k)*(-0.444444444444444)
     & + gtyz(i+1,j+1,k)*(0.444444444444444)
     & + gtyz(i+1,j+2,k)*(-0.0555555555555556)
     & + gtyz(i+2,j-2,k)*(-0.00694444444444444)
     & + gtyz(i+2,j-1,k)*(0.0555555555555556)
     & + gtyz(i+2,j+1,k)*(-0.0555555555555556)
     & + gtyz(i+2,j+2,k)*(0.00694444444444444)
     & )*idxsq
        dd_gtd(1,3,2,3) = (
     & + gtyz(i-2,j,k-2)*(0.00694444444444444)
     & + gtyz(i-2,j,k-1)*(-0.0555555555555556)
     & + gtyz(i-2,j,k+1)*(0.0555555555555556)
     & + gtyz(i-2,j,k+2)*(-0.00694444444444444)
     & + gtyz(i-1,j,k-2)*(-0.0555555555555556)
     & + gtyz(i-1,j,k-1)*(0.444444444444444)
     & + gtyz(i-1,j,k+1)*(-0.444444444444444)
     & + gtyz(i-1,j,k+2)*(0.0555555555555556)
     & + gtyz(i+1,j,k-2)*(0.0555555555555556)
     & + gtyz(i+1,j,k-1)*(-0.444444444444444)
     & + gtyz(i+1,j,k+1)*(0.444444444444444)
     & + gtyz(i+1,j,k+2)*(-0.0555555555555556)
     & + gtyz(i+2,j,k-2)*(-0.00694444444444444)
     & + gtyz(i+2,j,k-1)*(0.0555555555555556)
     & + gtyz(i+2,j,k+1)*(-0.0555555555555556)
     & + gtyz(i+2,j,k+2)*(0.00694444444444444)
     & )*idxsq
        dd_gtd(2,3,2,3) = (
     & + gtyz(i,j-2,k-2)*(0.00694444444444444)
     & + gtyz(i,j-2,k-1)*(-0.0555555555555556)
     & + gtyz(i,j-2,k+1)*(0.0555555555555556)
     & + gtyz(i,j-2,k+2)*(-0.00694444444444444)
     & + gtyz(i,j-1,k-2)*(-0.0555555555555556)
     & + gtyz(i,j-1,k-1)*(0.444444444444444)
     & + gtyz(i,j-1,k+1)*(-0.444444444444444)
     & + gtyz(i,j-1,k+2)*(0.0555555555555556)
     & + gtyz(i,j+1,k-2)*(0.0555555555555556)
     & + gtyz(i,j+1,k-1)*(-0.444444444444444)
     & + gtyz(i,j+1,k+1)*(0.444444444444444)
     & + gtyz(i,j+1,k+2)*(-0.0555555555555556)
     & + gtyz(i,j+2,k-2)*(-0.00694444444444444)
     & + gtyz(i,j+2,k-1)*(0.0555555555555556)
     & + gtyz(i,j+2,k+1)*(-0.0555555555555556)
     & + gtyz(i,j+2,k+2)*(0.00694444444444444)
     & )*idxsq
        gtd(3,3) = gtzz(i,j,k)
        d_gtd(1,3,3) = (
     & + gtzz(i-2,j,k)*(0.0833333333333333d0)
     & + gtzz(i-1,j,k)*(-0.666666666666667d0)
     & + gtzz(i+1,j,k)*(0.666666666666667d0)
     & + gtzz(i+2,j,k)*(-0.0833333333333333d0)
     & )*idx
        d_gtd(2,3,3) = (
     & + gtzz(i,j-2,k)*(0.0833333333333333d0)
     & + gtzz(i,j-1,k)*(-0.666666666666667d0)
     & + gtzz(i,j+1,k)*(0.666666666666667d0)
     & + gtzz(i,j+2,k)*(-0.0833333333333333d0)
     & )*idx
        d_gtd(3,3,3) = (
     & + gtzz(i,j,k-2)*(0.0833333333333333d0)
     & + gtzz(i,j,k-1)*(-0.666666666666667d0)
     & + gtzz(i,j,k+1)*(0.666666666666667d0)
     & + gtzz(i,j,k+2)*(-0.0833333333333333d0)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_gtd(1,3,3) = (
     & + gtzz(i-1,j,k)*(-0.25d0)
     & + gtzz(i,j,k)*(-0.833333333333333d0)
     & + gtzz(i+1,j,k)*(1.5d0)
     & + gtzz(i+2,j,k)*(-0.5d0)
     & + gtzz(i+3,j,k)*(0.0833333333333333d0)
     & )*idx
        else
        adv_d_gtd(1,3,3) = (
     & + gtzz(i-3,j,k)*(-0.0833333333333333d0)
     & + gtzz(i-2,j,k)*(0.5d0)
     & + gtzz(i-1,j,k)*(-1.5d0)
     & + gtzz(i  ,j,k)*(0.833333333333333d0)
     & + gtzz(i+1,j,k)*(0.25d0)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_gtd(2,3,3) = (
     & + gtzz(i,j-1,k)*(-0.25)
     & + gtzz(i,j  ,k)*(-0.833333333333333)
     & + gtzz(i,j+1,k)*(1.5)
     & + gtzz(i,j+2,k)*(-0.5)
     & + gtzz(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_gtd(2,3,3) = (
     & + gtzz(i,j-3,k)*(-0.0833333333333333)
     & + gtzz(i,j-2,k)*(0.5)
     & + gtzz(i,j-1,k)*(-1.5)
     & + gtzz(i,j  ,k)*(0.833333333333333)
     & + gtzz(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_gtd(3,3,3) = (
     & + gtzz(i,j,k-1)*(-0.25)
     & + gtzz(i,j,k)*(-0.833333333333333)
     & + gtzz(i,j,k+1)*(1.5)
     & + gtzz(i,j,k+2)*(-0.5)
     & + gtzz(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_gtd(3,3,3) = (
     & + gtzz(i,j,k-3)*(-0.0833333333333333)
     & + gtzz(i,j,k-2)*(0.5)
     & + gtzz(i,j,k-1)*(-1.5)
     & + gtzz(i,j,k)*(0.833333333333333)
     & + gtzz(i,j,k+1)*(0.25)
     & )*idx
        end if
        dd_gtd(1,1,3,3) = (
     & + gtzz(i-2,j,k)*(-0.0833333333333333)
     & + gtzz(i-1,j,k)*(1.33333333333333)
     & + gtzz(i,j,k)*(-2.5)
     & + gtzz(i+1,j,k)*(1.33333333333333)
     & + gtzz(i+2,j,k)*(-0.0833333333333333)
     & )*idxsq
        dd_gtd(2,2,3,3) = (
     & + gtzz(i,j-2,k)*(-0.0833333333333333)
     & + gtzz(i,j-1,k)*(1.33333333333333)
     & + gtzz(i,j,k)*(-2.5)
     & + gtzz(i,j+1,k)*(1.33333333333333)
     & + gtzz(i,j+2,k)*(-0.0833333333333333)
     & )*idxsq
        dd_gtd(3,3,3,3) = (
     & + gtzz(i,j,k-2)*(-0.0833333333333333)
     & + gtzz(i,j,k-1)*(1.33333333333333)
     & + gtzz(i,j,k)*(-2.5)
     & + gtzz(i,j,k+1)*(1.33333333333333)
     & + gtzz(i,j,k+2)*(-0.0833333333333333)
     & )*idxsq
        dd_gtd(1,2,3,3) = (
     & + gtzz(i-2,j-2,k)*(0.00694444444444444)
     & + gtzz(i-2,j-1,k)*(-0.0555555555555556)
     & + gtzz(i-2,j+1,k)*(0.0555555555555556)
     & + gtzz(i-2,j+2,k)*(-0.00694444444444444)
     & + gtzz(i-1,j-2,k)*(-0.0555555555555556)
     & + gtzz(i-1,j-1,k)*(0.444444444444444)
     & + gtzz(i-1,j+1,k)*(-0.444444444444444)
     & + gtzz(i-1,j+2,k)*(0.0555555555555556)
     & + gtzz(i+1,j-2,k)*(0.0555555555555556)
     & + gtzz(i+1,j-1,k)*(-0.444444444444444)
     & + gtzz(i+1,j+1,k)*(0.444444444444444)
     & + gtzz(i+1,j+2,k)*(-0.0555555555555556)
     & + gtzz(i+2,j-2,k)*(-0.00694444444444444)
     & + gtzz(i+2,j-1,k)*(0.0555555555555556)
     & + gtzz(i+2,j+1,k)*(-0.0555555555555556)
     & + gtzz(i+2,j+2,k)*(0.00694444444444444)
     & )*idxsq
        dd_gtd(1,3,3,3) = (
     & + gtzz(i-2,j,k-2)*(0.00694444444444444)
     & + gtzz(i-2,j,k-1)*(-0.0555555555555556)
     & + gtzz(i-2,j,k+1)*(0.0555555555555556)
     & + gtzz(i-2,j,k+2)*(-0.00694444444444444)
     & + gtzz(i-1,j,k-2)*(-0.0555555555555556)
     & + gtzz(i-1,j,k-1)*(0.444444444444444)
     & + gtzz(i-1,j,k+1)*(-0.444444444444444)
     & + gtzz(i-1,j,k+2)*(0.0555555555555556)
     & + gtzz(i+1,j,k-2)*(0.0555555555555556)
     & + gtzz(i+1,j,k-1)*(-0.444444444444444)
     & + gtzz(i+1,j,k+1)*(0.444444444444444)
     & + gtzz(i+1,j,k+2)*(-0.0555555555555556)
     & + gtzz(i+2,j,k-2)*(-0.00694444444444444)
     & + gtzz(i+2,j,k-1)*(0.0555555555555556)
     & + gtzz(i+2,j,k+1)*(-0.0555555555555556)
     & + gtzz(i+2,j,k+2)*(0.00694444444444444)
     & )*idxsq
        dd_gtd(2,3,3,3) = (
     & + gtzz(i,j-2,k-2)*(0.00694444444444444)
     & + gtzz(i,j-2,k-1)*(-0.0555555555555556)
     & + gtzz(i,j-2,k+1)*(0.0555555555555556)
     & + gtzz(i,j-2,k+2)*(-0.00694444444444444)
     & + gtzz(i,j-1,k-2)*(-0.0555555555555556)
     & + gtzz(i,j-1,k-1)*(0.444444444444444)
     & + gtzz(i,j-1,k+1)*(-0.444444444444444)
     & + gtzz(i,j-1,k+2)*(0.0555555555555556)
     & + gtzz(i,j+1,k-2)*(0.0555555555555556)
     & + gtzz(i,j+1,k-1)*(-0.444444444444444)
     & + gtzz(i,j+1,k+1)*(0.444444444444444)
     & + gtzz(i,j+1,k+2)*(-0.0555555555555556)
     & + gtzz(i,j+2,k-2)*(-0.00694444444444444)
     & + gtzz(i,j+2,k-1)*(0.0555555555555556)
     & + gtzz(i,j+2,k+1)*(-0.0555555555555556)
     & + gtzz(i,j+2,k+2)*(0.00694444444444444)
     & )*idxsq
        Atd(1,1) = Atxx(i,j,k)
        d_Atd(1,1,1) = (
     & + Atxx(i-2,j,k)*(0.0833333333333333)
     & + Atxx(i-1,j,k)*(-0.666666666666667)
     & + Atxx(i+1,j,k)*(0.666666666666667)
     & + Atxx(i+2,j,k)*(-0.0833333333333333)
     & )*idx
        d_Atd(2,1,1) = (
     & + Atxx(i,j-2,k)*(0.0833333333333333)
     & + Atxx(i,j-1,k)*(-0.666666666666667)
     & + Atxx(i,j+1,k)*(0.666666666666667)
     & + Atxx(i,j+2,k)*(-0.0833333333333333)
     & )*idx
        d_Atd(3,1,1) = (
     & + Atxx(i,j,k-2)*(0.0833333333333333)
     & + Atxx(i,j,k-1)*(-0.666666666666667)
     & + Atxx(i,j,k+1)*(0.666666666666667)
     & + Atxx(i,j,k+2)*(-0.0833333333333333)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_Atd(1,1,1) = (
     & + Atxx(i-1,j,k)*(-0.25)
     & + Atxx(i  ,j,k)*(-0.833333333333333)
     & + Atxx(i+1,j,k)*(1.5)
     & + Atxx(i+2,j,k)*(-0.5)
     & + Atxx(i+3,j,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Atd(1,1,1) = (
     & + Atxx(i-3,j,k)*(-0.0833333333333333)
     & + Atxx(i-2,j,k)*(0.5)
     & + Atxx(i-1,j,k)*(-1.5)
     & + Atxx(i,j,k)*(0.833333333333333)
     & + Atxx(i+1,j,k)*(0.25)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_Atd(2,1,1) = (
     & + Atxx(i,j-1,k)*(-0.25)
     & + Atxx(i,j,k)*(-0.833333333333333)
     & + Atxx(i,j+1,k)*(1.5)
     & + Atxx(i,j+2,k)*(-0.5)
     & + Atxx(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Atd(2,1,1) = (
     & + Atxx(i,j-3,k)*(-0.0833333333333333)
     & + Atxx(i,j-2,k)*(0.5)
     & + Atxx(i,j-1,k)*(-1.5)
     & + Atxx(i,j,k)*(0.833333333333333)
     & + Atxx(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_Atd(3,1,1) = (
     & + Atxx(i,j,k-1)*(-0.25)
     & + Atxx(i,j,k)*(-0.833333333333333)
     & + Atxx(i,j,k+1)*(1.5)
     & + Atxx(i,j,k+2)*(-0.5)
     & + Atxx(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Atd(3,1,1) = (
     & + Atxx(i,j,k-3)*(-0.0833333333333333)
     & + Atxx(i,j,k-2)*(0.5)
     & + Atxx(i,j,k-1)*(-1.5)
     & + Atxx(i,j,k)*(0.833333333333333)
     & + Atxx(i,j,k+1)*(0.25)
     & )*idx
        end if
        Atd(1,2) = Atxy(i,j,k)
        d_Atd(1,1,2) = (
     & + Atxy(i-2,j,k)*(0.0833333333333333)
     & + Atxy(i-1,j,k)*(-0.666666666666667)
     & + Atxy(i+1,j,k)*(0.666666666666667)
     & + Atxy(i+2,j,k)*(-0.0833333333333333)
     & )*idx
        d_Atd(2,1,2) = (
     & + Atxy(i,j-2,k)*(0.0833333333333333)
     & + Atxy(i,j-1,k)*(-0.666666666666667)
     & + Atxy(i,j+1,k)*(0.666666666666667)
     & + Atxy(i,j+2,k)*(-0.0833333333333333)
     & )*idx
        d_Atd(3,1,2) = (
     & + Atxy(i,j,k-2)*(0.0833333333333333)
     & + Atxy(i,j,k-1)*(-0.666666666666667)
     & + Atxy(i,j,k+1)*(0.666666666666667)
     & + Atxy(i,j,k+2)*(-0.0833333333333333)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_Atd(1,1,2) = (
     & + Atxy(i-1,j,k)*(-0.25)
     & + Atxy(i  ,j,k)*(-0.833333333333333)
     & + Atxy(i+1,j,k)*(1.5)
     & + Atxy(i+2,j,k)*(-0.5)
     & + Atxy(i+3,j,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Atd(1,1,2) = (
     & + Atxy(i-3,j,k)*(-0.0833333333333333)
     & + Atxy(i-2,j,k)*(0.5)
     & + Atxy(i-1,j,k)*(-1.5)
     & + Atxy(i,j,k)*(0.833333333333333)
     & + Atxy(i+1,j,k)*(0.25)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_Atd(2,1,2) = (
     & + Atxy(i,j-1,k)*(-0.25)
     & + Atxy(i,j,k)*(-0.833333333333333)
     & + Atxy(i,j+1,k)*(1.5)
     & + Atxy(i,j+2,k)*(-0.5)
     & + Atxy(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Atd(2,1,2) = (
     & + Atxy(i,j-3,k)*(-0.0833333333333333)
     & + Atxy(i,j-2,k)*(0.5)
     & + Atxy(i,j-1,k)*(-1.5)
     & + Atxy(i,j,k)*(0.833333333333333)
     & + Atxy(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_Atd(3,1,2) = (
     & + Atxy(i,j,k-1)*(-0.25)
     & + Atxy(i,j,k)*(-0.833333333333333)
     & + Atxy(i,j,k+1)*(1.5)
     & + Atxy(i,j,k+2)*(-0.5)
     & + Atxy(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Atd(3,1,2) = (
     & + Atxy(i,j,k-3)*(-0.0833333333333333)
     & + Atxy(i,j,k-2)*(0.5)
     & + Atxy(i,j,k-1)*(-1.5)
     & + Atxy(i,j,k)*(0.833333333333333)
     & + Atxy(i,j,k+1)*(0.25)
     & )*idx
        end if
        Atd(1,3) = Atxz(i,j,k)
        d_Atd(1,1,3) = (
     & + Atxz(i-2,j,k)*(0.0833333333333333)
     & + Atxz(i-1,j,k)*(-0.666666666666667)
     & + Atxz(i+1,j,k)*(0.666666666666667)
     & + Atxz(i+2,j,k)*(-0.0833333333333333)
     & )*idx
        d_Atd(2,1,3) = (
     & + Atxz(i,j-2,k)*(0.0833333333333333)
     & + Atxz(i,j-1,k)*(-0.666666666666667)
     & + Atxz(i,j+1,k)*(0.666666666666667)
     & + Atxz(i,j+2,k)*(-0.0833333333333333)
     & )*idx
        d_Atd(3,1,3) = (
     & + Atxz(i,j,k-2)*(0.0833333333333333)
     & + Atxz(i,j,k-1)*(-0.666666666666667)
     & + Atxz(i,j,k+1)*(0.666666666666667)
     & + Atxz(i,j,k+2)*(-0.0833333333333333)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_Atd(1,1,3) = (
     & + Atxz(i-1,j,k)*(-0.25)
     & + Atxz(i  ,j,k)*(-0.833333333333333)
     & + Atxz(i+1,j,k)*(1.5)
     & + Atxz(i+2,j,k)*(-0.5)
     & + Atxz(i+3,j,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Atd(1,1,3) = (
     & + Atxz(i-3,j,k)*(-0.0833333333333333)
     & + Atxz(i-2,j,k)*(0.5)
     & + Atxz(i-1,j,k)*(-1.5)
     & + Atxz(i,j,k)*(0.833333333333333)
     & + Atxz(i+1,j,k)*(0.25)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_Atd(2,1,3) = (
     & + Atxz(i,j-1,k)*(-0.25)
     & + Atxz(i,j,k)*(-0.833333333333333)
     & + Atxz(i,j+1,k)*(1.5)
     & + Atxz(i,j+2,k)*(-0.5)
     & + Atxz(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Atd(2,1,3) = (
     & + Atxz(i,j-3,k)*(-0.0833333333333333)
     & + Atxz(i,j-2,k)*(0.5)
     & + Atxz(i,j-1,k)*(-1.5)
     & + Atxz(i,j,k)*(0.833333333333333)
     & + Atxz(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_Atd(3,1,3) = (
     & + Atxz(i,j,k-1)*(-0.25)
     & + Atxz(i,j,k)*(-0.833333333333333)
     & + Atxz(i,j,k+1)*(1.5)
     & + Atxz(i,j,k+2)*(-0.5)
     & + Atxz(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Atd(3,1,3) = (
     & + Atxz(i,j,k-3)*(-0.0833333333333333)
     & + Atxz(i,j,k-2)*(0.5)
     & + Atxz(i,j,k-1)*(-1.5)
     & + Atxz(i,j,k)*(0.833333333333333)
     & + Atxz(i,j,k+1)*(0.25)
     & )*idx
        end if
        Atd(2,2) = Atyy(i,j,k)
        d_Atd(1,2,2) = (
     & + Atyy(i-2,j,k)*(0.0833333333333333)
     & + Atyy(i-1,j,k)*(-0.666666666666667)
     & + Atyy(i+1,j,k)*(0.666666666666667)
     & + Atyy(i+2,j,k)*(-0.0833333333333333)
     & )*idx
        d_Atd(2,2,2) = (
     & + Atyy(i,j-2,k)*(0.0833333333333333)
     & + Atyy(i,j-1,k)*(-0.666666666666667)
     & + Atyy(i,j+1,k)*(0.666666666666667)
     & + Atyy(i,j+2,k)*(-0.0833333333333333)
     & )*idx
        d_Atd(3,2,2) = (
     & + Atyy(i,j,k-2)*(0.0833333333333333)
     & + Atyy(i,j,k-1)*(-0.666666666666667)
     & + Atyy(i,j,k+1)*(0.666666666666667)
     & + Atyy(i,j,k+2)*(-0.0833333333333333)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_Atd(1,2,2) = (
     & + Atyy(i-1,j,k)*(-0.25)
     & + Atyy(i  ,j,k)*(-0.833333333333333)
     & + Atyy(i+1,j,k)*(1.5)
     & + Atyy(i+2,j,k)*(-0.5)
     & + Atyy(i+3,j,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Atd(1,2,2) = (
     & + Atyy(i-3,j,k)*(-0.0833333333333333)
     & + Atyy(i-2,j,k)*(0.5)
     & + Atyy(i-1,j,k)*(-1.5)
     & + Atyy(i,j,k)*(0.833333333333333)
     & + Atyy(i+1,j,k)*(0.25)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_Atd(2,2,2) = (
     & + Atyy(i,j-1,k)*(-0.25)
     & + Atyy(i,j,k)*(-0.833333333333333)
     & + Atyy(i,j+1,k)*(1.5)
     & + Atyy(i,j+2,k)*(-0.5)
     & + Atyy(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Atd(2,2,2) = (
     & + Atyy(i,j-3,k)*(-0.0833333333333333)
     & + Atyy(i,j-2,k)*(0.5)
     & + Atyy(i,j-1,k)*(-1.5)
     & + Atyy(i,j,k)*(0.833333333333333)
     & + Atyy(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_Atd(3,2,2) = (
     & + Atyy(i,j,k-1)*(-0.25)
     & + Atyy(i,j,k)*(-0.833333333333333)
     & + Atyy(i,j,k+1)*(1.5)
     & + Atyy(i,j,k+2)*(-0.5)
     & + Atyy(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Atd(3,2,2) = (
     & + Atyy(i,j,k-3)*(-0.0833333333333333)
     & + Atyy(i,j,k-2)*(0.5)
     & + Atyy(i,j,k-1)*(-1.5)
     & + Atyy(i,j,k)*(0.833333333333333)
     & + Atyy(i,j,k+1)*(0.25)
     & )*idx
        end if
        Atd(2,3) = Atyz(i,j,k)
        d_Atd(1,2,3) = (
     & + Atyz(i-2,j,k)*(0.0833333333333333)
     & + Atyz(i-1,j,k)*(-0.666666666666667)
     & + Atyz(i+1,j,k)*(0.666666666666667)
     & + Atyz(i+2,j,k)*(-0.0833333333333333)
     & )*idx
        d_Atd(2,2,3) = (
     & + Atyz(i,j-2,k)*(0.0833333333333333)
     & + Atyz(i,j-1,k)*(-0.666666666666667)
     & + Atyz(i,j+1,k)*(0.666666666666667)
     & + Atyz(i,j+2,k)*(-0.0833333333333333)
     & )*idx
        d_Atd(3,2,3) = (
     & + Atyz(i,j,k-2)*(0.0833333333333333)
     & + Atyz(i,j,k-1)*(-0.666666666666667)
     & + Atyz(i,j,k+1)*(0.666666666666667)
     & + Atyz(i,j,k+2)*(-0.0833333333333333)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_Atd(1,2,3) = (
     & + Atyz(i-1,j,k)*(-0.25)
     & + Atyz(i  ,j,k)*(-0.833333333333333)
     & + Atyz(i+1,j,k)*(1.5)
     & + Atyz(i+2,j,k)*(-0.5)
     & + Atyz(i+3,j,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Atd(1,2,3) = (
     & + Atyz(i-3,j,k)*(-0.0833333333333333)
     & + Atyz(i-2,j,k)*(0.5)
     & + Atyz(i-1,j,k)*(-1.5)
     & + Atyz(i,j,k)*(0.833333333333333)
     & + Atyz(i+1,j,k)*(0.25)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_Atd(2,2,3) = (
     & + Atyz(i,j-1,k)*(-0.25)
     & + Atyz(i,j,k)*(-0.833333333333333)
     & + Atyz(i,j+1,k)*(1.5)
     & + Atyz(i,j+2,k)*(-0.5)
     & + Atyz(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Atd(2,2,3) = (
     & + Atyz(i,j-3,k)*(-0.0833333333333333)
     & + Atyz(i,j-2,k)*(0.5)
     & + Atyz(i,j-1,k)*(-1.5)
     & + Atyz(i,j,k)*(0.833333333333333)
     & + Atyz(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_Atd(3,2,3) = (
     & + Atyz(i,j,k-1)*(-0.25)
     & + Atyz(i,j,k)*(-0.833333333333333)
     & + Atyz(i,j,k+1)*(1.5)
     & + Atyz(i,j,k+2)*(-0.5)
     & + Atyz(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Atd(3,2,3) = (
     & + Atyz(i,j,k-3)*(-0.0833333333333333)
     & + Atyz(i,j,k-2)*(0.5)
     & + Atyz(i,j,k-1)*(-1.5)
     & + Atyz(i,j,k)*(0.833333333333333)
     & + Atyz(i,j,k+1)*(0.25)
     & )*idx
        end if
        Atd(3,3) = Atzz(i,j,k)
        d_Atd(1,3,3) = (
     & + Atzz(i-2,j,k)*(0.0833333333333333)
     & + Atzz(i-1,j,k)*(-0.666666666666667)
     & + Atzz(i+1,j,k)*(0.666666666666667)
     & + Atzz(i+2,j,k)*(-0.0833333333333333)
     & )*idx
        d_Atd(2,3,3) = (
     & + Atzz(i,j-2,k)*(0.0833333333333333)
     & + Atzz(i,j-1,k)*(-0.666666666666667)
     & + Atzz(i,j+1,k)*(0.666666666666667)
     & + Atzz(i,j+2,k)*(-0.0833333333333333)
     & )*idx
        d_Atd(3,3,3) = (
     & + Atzz(i,j,k-2)*(0.0833333333333333)
     & + Atzz(i,j,k-1)*(-0.666666666666667)
     & + Atzz(i,j,k+1)*(0.666666666666667)
     & + Atzz(i,j,k+2)*(-0.0833333333333333)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_Atd(1,3,3) = (
     & + Atzz(i-1,j,k)*(-0.25)
     & + Atzz(i  ,j,k)*(-0.833333333333333)
     & + Atzz(i+1,j,k)*(1.5)
     & + Atzz(i+2,j,k)*(-0.5)
     & + Atzz(i+3,j,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Atd(1,3,3) = (
     & + Atzz(i-3,j,k)*(-0.0833333333333333)
     & + Atzz(i-2,j,k)*(0.5)
     & + Atzz(i-1,j,k)*(-1.5)
     & + Atzz(i,j,k)*(0.833333333333333)
     & + Atzz(i+1,j,k)*(0.25)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_Atd(2,3,3) = (
     & + Atzz(i,j-1,k)*(-0.25)
     & + Atzz(i,j,k)*(-0.833333333333333)
     & + Atzz(i,j+1,k)*(1.5)
     & + Atzz(i,j+2,k)*(-0.5)
     & + Atzz(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Atd(2,3,3) = (
     & + Atzz(i,j-3,k)*(-0.0833333333333333)
     & + Atzz(i,j-2,k)*(0.5)
     & + Atzz(i,j-1,k)*(-1.5)
     & + Atzz(i,j,k)*(0.833333333333333)
     & + Atzz(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_Atd(3,3,3) = (
     & + Atzz(i,j,k-1)*(-0.25)
     & + Atzz(i,j,k)*(-0.833333333333333)
     & + Atzz(i,j,k+1)*(1.5)
     & + Atzz(i,j,k+2)*(-0.5)
     & + Atzz(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Atd(3,3,3) = (
     & + Atzz(i,j,k-3)*(-0.0833333333333333)
     & + Atzz(i,j,k-2)*(0.5)
     & + Atzz(i,j,k-1)*(-1.5)
     & + Atzz(i,j,k)*(0.833333333333333)
     & + Atzz(i,j,k+1)*(0.25)
     & )*idx
        end if
        chi = chi3D(i,j,k)
        d_chi(1) = (
     & + chi3D(i-2,j,k)*(0.0833333333333333d0)
     & + chi3D(i-1,j,k)*(-0.666666666666667d0)
     & + chi3D(i+1,j,k)*(0.666666666666667d0)
     & + chi3D(i+2,j,k)*(-0.0833333333333333d0)
     & )*idx
        d_chi(2) = (
     & + chi3D(i,j-2,k)*(0.0833333333333333d0)
     & + chi3D(i,j-1,k)*(-0.666666666666667d0)
     & + chi3D(i,j+1,k)*(0.666666666666667d0)
     & + chi3D(i,j+2,k)*(-0.0833333333333333d0)
     & )*idx
        d_chi(3) = (
     & + chi3D(i,j,k-2)*(0.0833333333333333d0)
     & + chi3D(i,j,k-1)*(-0.666666666666667d0)
     & + chi3D(i,j,k+1)*(0.666666666666667d0)
     & + chi3D(i,j,k+2)*(-0.0833333333333333d0)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_chi(1) = (
     & + chi3D(i-1,j,k)*(-0.25d0)
     & + chi3D(i,j,k)*(-0.833333333333333d0)
     & + chi3D(i+1,j,k)*(1.5d0)
     & + chi3D(i+2,j,k)*(-0.5d0)
     & + chi3D(i+3,j,k)*(0.0833333333333333d0)
     & )*idx
        else
        adv_d_chi(1) = (
     & + chi3D(i-3,j,k)*(-0.0833333333333333d0)
     & + chi3D(i-2,j,k)*(0.5d0)
     & + chi3D(i-1,j,k)*(-1.5d0)
     & + chi3D(i  ,j,k)*(0.833333333333333d0)
     & + chi3D(i+1,j,k)*(0.25d0)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_chi(2) = (
     & + chi3D(i,j-1,k)*(-0.25)
     & + chi3D(i,j  ,k)*(-0.833333333333333)
     & + chi3D(i,j+1,k)*(1.5)
     & + chi3D(i,j+2,k)*(-0.5)
     & + chi3D(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_chi(2) = (
     & + chi3D(i,j-3,k)*(-0.0833333333333333)
     & + chi3D(i,j-2,k)*(0.5)
     & + chi3D(i,j-1,k)*(-1.5)
     & + chi3D(i,j  ,k)*(0.833333333333333)
     & + chi3D(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_chi(3) = (
     & + chi3D(i,j,k-1)*(-0.25)
     & + chi3D(i,j,k)*(-0.833333333333333)
     & + chi3D(i,j,k+1)*(1.5)
     & + chi3D(i,j,k+2)*(-0.5)
     & + chi3D(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_chi(3) = (
     & + chi3D(i,j,k-3)*(-0.0833333333333333)
     & + chi3D(i,j,k-2)*(0.5)
     & + chi3D(i,j,k-1)*(-1.5)
     & + chi3D(i,j,k)*(0.833333333333333)
     & + chi3D(i,j,k+1)*(0.25)
     & )*idx
        end if
        dd_chi(1,1) = (
     & + chi3D(i-2,j,k)*(-0.0833333333333333)
     & + chi3D(i-1,j,k)*(1.33333333333333)
     & + chi3D(i,j,k)*(-2.5)
     & + chi3D(i+1,j,k)*(1.33333333333333)
     & + chi3D(i+2,j,k)*(-0.0833333333333333)
     & )*idxsq
        dd_chi(2,2) = (
     & + chi3D(i,j-2,k)*(-0.0833333333333333)
     & + chi3D(i,j-1,k)*(1.33333333333333)
     & + chi3D(i,j,k)*(-2.5)
     & + chi3D(i,j+1,k)*(1.33333333333333)
     & + chi3D(i,j+2,k)*(-0.0833333333333333)
     & )*idxsq
        dd_chi(3,3) = (
     & + chi3D(i,j,k-2)*(-0.0833333333333333)
     & + chi3D(i,j,k-1)*(1.33333333333333)
     & + chi3D(i,j,k)*(-2.5)
     & + chi3D(i,j,k+1)*(1.33333333333333)
     & + chi3D(i,j,k+2)*(-0.0833333333333333)
     & )*idxsq
        dd_chi(1,2) = (
     & + chi3D(i-2,j-2,k)*(0.00694444444444444)
     & + chi3D(i-2,j-1,k)*(-0.0555555555555556)
     & + chi3D(i-2,j+1,k)*(0.0555555555555556)
     & + chi3D(i-2,j+2,k)*(-0.00694444444444444)
     & + chi3D(i-1,j-2,k)*(-0.0555555555555556)
     & + chi3D(i-1,j-1,k)*(0.444444444444444)
     & + chi3D(i-1,j+1,k)*(-0.444444444444444)
     & + chi3D(i-1,j+2,k)*(0.0555555555555556)
     & + chi3D(i+1,j-2,k)*(0.0555555555555556)
     & + chi3D(i+1,j-1,k)*(-0.444444444444444)
     & + chi3D(i+1,j+1,k)*(0.444444444444444)
     & + chi3D(i+1,j+2,k)*(-0.0555555555555556)
     & + chi3D(i+2,j-2,k)*(-0.00694444444444444)
     & + chi3D(i+2,j-1,k)*(0.0555555555555556)
     & + chi3D(i+2,j+1,k)*(-0.0555555555555556)
     & + chi3D(i+2,j+2,k)*(0.00694444444444444)
     & )*idxsq
        dd_chi(1,3) = (
     & + chi3D(i-2,j,k-2)*(0.00694444444444444)
     & + chi3D(i-2,j,k-1)*(-0.0555555555555556)
     & + chi3D(i-2,j,k+1)*(0.0555555555555556)
     & + chi3D(i-2,j,k+2)*(-0.00694444444444444)
     & + chi3D(i-1,j,k-2)*(-0.0555555555555556)
     & + chi3D(i-1,j,k-1)*(0.444444444444444)
     & + chi3D(i-1,j,k+1)*(-0.444444444444444)
     & + chi3D(i-1,j,k+2)*(0.0555555555555556)
     & + chi3D(i+1,j,k-2)*(0.0555555555555556)
     & + chi3D(i+1,j,k-1)*(-0.444444444444444)
     & + chi3D(i+1,j,k+1)*(0.444444444444444)
     & + chi3D(i+1,j,k+2)*(-0.0555555555555556)
     & + chi3D(i+2,j,k-2)*(-0.00694444444444444)
     & + chi3D(i+2,j,k-1)*(0.0555555555555556)
     & + chi3D(i+2,j,k+1)*(-0.0555555555555556)
     & + chi3D(i+2,j,k+2)*(0.00694444444444444)
     & )*idxsq
        dd_chi(2,3) = (
     & + chi3D(i,j-2,k-2)*(0.00694444444444444)
     & + chi3D(i,j-2,k-1)*(-0.0555555555555556)
     & + chi3D(i,j-2,k+1)*(0.0555555555555556)
     & + chi3D(i,j-2,k+2)*(-0.00694444444444444)
     & + chi3D(i,j-1,k-2)*(-0.0555555555555556)
     & + chi3D(i,j-1,k-1)*(0.444444444444444)
     & + chi3D(i,j-1,k+1)*(-0.444444444444444)
     & + chi3D(i,j-1,k+2)*(0.0555555555555556)
     & + chi3D(i,j+1,k-2)*(0.0555555555555556)
     & + chi3D(i,j+1,k-1)*(-0.444444444444444)
     & + chi3D(i,j+1,k+1)*(0.444444444444444)
     & + chi3D(i,j+1,k+2)*(-0.0555555555555556)
     & + chi3D(i,j+2,k-2)*(-0.00694444444444444)
     & + chi3D(i,j+2,k-1)*(0.0555555555555556)
     & + chi3D(i,j+2,k+1)*(-0.0555555555555556)
     & + chi3D(i,j+2,k+2)*(0.00694444444444444)
     & )*idxsq
        trK = trK3D(i,j,k)
        d_trK(1) = (
     & + trK3D(i-2,j,k)*(0.0833333333333333)
     & + trK3D(i-1,j,k)*(-0.666666666666667)
     & + trK3D(i+1,j,k)*(0.666666666666667)
     & + trK3D(i+2,j,k)*(-0.0833333333333333)
     & )*idx
        d_trK(2) = (
     & + trK3D(i,j-2,k)*(0.0833333333333333)
     & + trK3D(i,j-1,k)*(-0.666666666666667)
     & + trK3D(i,j+1,k)*(0.666666666666667)
     & + trK3D(i,j+2,k)*(-0.0833333333333333)
     & )*idx
        d_trK(3) = (
     & + trK3D(i,j,k-2)*(0.0833333333333333)
     & + trK3D(i,j,k-1)*(-0.666666666666667)
     & + trK3D(i,j,k+1)*(0.666666666666667)
     & + trK3D(i,j,k+2)*(-0.0833333333333333)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_trK(1) = (
     & + trK3D(i-1,j,k)*(-0.25)
     & + trK3D(i  ,j,k)*(-0.833333333333333)
     & + trK3D(i+1,j,k)*(1.5)
     & + trK3D(i+2,j,k)*(-0.5)
     & + trK3D(i+3,j,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_trK(1) = (
     & + trK3D(i-3,j,k)*(-0.0833333333333333)
     & + trK3D(i-2,j,k)*(0.5)
     & + trK3D(i-1,j,k)*(-1.5)
     & + trK3D(i,j,k)*(0.833333333333333)
     & + trK3D(i+1,j,k)*(0.25)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_trK(2) = (
     & + trK3D(i,j-1,k)*(-0.25)
     & + trK3D(i,j,k)*(-0.833333333333333)
     & + trK3D(i,j+1,k)*(1.5)
     & + trK3D(i,j+2,k)*(-0.5)
     & + trK3D(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_trK(2) = (
     & + trK3D(i,j-3,k)*(-0.0833333333333333)
     & + trK3D(i,j-2,k)*(0.5)
     & + trK3D(i,j-1,k)*(-1.5)
     & + trK3D(i,j,k)*(0.833333333333333)
     & + trK3D(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_trK(3) = (
     & + trK3D(i,j,k-1)*(-0.25)
     & + trK3D(i,j,k)*(-0.833333333333333)
     & + trK3D(i,j,k+1)*(1.5)
     & + trK3D(i,j,k+2)*(-0.5)
     & + trK3D(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_trK(3) = (
     & + trK3D(i,j,k-3)*(-0.0833333333333333)
     & + trK3D(i,j,k-2)*(0.5)
     & + trK3D(i,j,k-1)*(-1.5)
     & + trK3D(i,j,k)*(0.833333333333333)
     & + trK3D(i,j,k+1)*(0.25)
     & )*idx
        end if
        Gamt(1) = Gamtx(i,j,k)
        d_Gamt(1,1) = (
     & + Gamtx(i-2,j,k)*(0.0833333333333333)
     & + Gamtx(i-1,j,k)*(-0.666666666666667)
     & + Gamtx(i+1,j,k)*(0.666666666666667)
     & + Gamtx(i+2,j,k)*(-0.0833333333333333)
     & )*idx
        d_Gamt(2,1) = (
     & + Gamtx(i,j-2,k)*(0.0833333333333333)
     & + Gamtx(i,j-1,k)*(-0.666666666666667)
     & + Gamtx(i,j+1,k)*(0.666666666666667)
     & + Gamtx(i,j+2,k)*(-0.0833333333333333)
     & )*idx
        d_Gamt(3,1) = (
     & + Gamtx(i,j,k-2)*(0.0833333333333333)
     & + Gamtx(i,j,k-1)*(-0.666666666666667)
     & + Gamtx(i,j,k+1)*(0.666666666666667)
     & + Gamtx(i,j,k+2)*(-0.0833333333333333)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_Gamt(1,1) = (
     & + Gamtx(i-1,j,k)*(-0.25)
     & + Gamtx(i  ,j,k)*(-0.833333333333333)
     & + Gamtx(i+1,j,k)*(1.5)
     & + Gamtx(i+2,j,k)*(-0.5)
     & + Gamtx(i+3,j,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Gamt(1,1) = (
     & + Gamtx(i-3,j,k)*(-0.0833333333333333)
     & + Gamtx(i-2,j,k)*(0.5)
     & + Gamtx(i-1,j,k)*(-1.5)
     & + Gamtx(i,j,k)*(0.833333333333333)
     & + Gamtx(i+1,j,k)*(0.25)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_Gamt(2,1) = (
     & + Gamtx(i,j-1,k)*(-0.25)
     & + Gamtx(i,j,k)*(-0.833333333333333)
     & + Gamtx(i,j+1,k)*(1.5)
     & + Gamtx(i,j+2,k)*(-0.5)
     & + Gamtx(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Gamt(2,1) = (
     & + Gamtx(i,j-3,k)*(-0.0833333333333333)
     & + Gamtx(i,j-2,k)*(0.5)
     & + Gamtx(i,j-1,k)*(-1.5)
     & + Gamtx(i,j,k)*(0.833333333333333)
     & + Gamtx(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_Gamt(3,1) = (
     & + Gamtx(i,j,k-1)*(-0.25)
     & + Gamtx(i,j,k)*(-0.833333333333333)
     & + Gamtx(i,j,k+1)*(1.5)
     & + Gamtx(i,j,k+2)*(-0.5)
     & + Gamtx(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Gamt(3,1) = (
     & + Gamtx(i,j,k-3)*(-0.0833333333333333)
     & + Gamtx(i,j,k-2)*(0.5)
     & + Gamtx(i,j,k-1)*(-1.5)
     & + Gamtx(i,j,k)*(0.833333333333333)
     & + Gamtx(i,j,k+1)*(0.25)
     & )*idx
        end if
        Gamt(2) = Gamty(i,j,k)
        d_Gamt(1,2) = (
     & + Gamty(i-2,j,k)*(0.0833333333333333)
     & + Gamty(i-1,j,k)*(-0.666666666666667)
     & + Gamty(i+1,j,k)*(0.666666666666667)
     & + Gamty(i+2,j,k)*(-0.0833333333333333)
     & )*idx
        d_Gamt(2,2) = (
     & + Gamty(i,j-2,k)*(0.0833333333333333)
     & + Gamty(i,j-1,k)*(-0.666666666666667)
     & + Gamty(i,j+1,k)*(0.666666666666667)
     & + Gamty(i,j+2,k)*(-0.0833333333333333)
     & )*idx
        d_Gamt(3,2) = (
     & + Gamty(i,j,k-2)*(0.0833333333333333)
     & + Gamty(i,j,k-1)*(-0.666666666666667)
     & + Gamty(i,j,k+1)*(0.666666666666667)
     & + Gamty(i,j,k+2)*(-0.0833333333333333)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_Gamt(1,2) = (
     & + Gamty(i-1,j,k)*(-0.25)
     & + Gamty(i  ,j,k)*(-0.833333333333333)
     & + Gamty(i+1,j,k)*(1.5)
     & + Gamty(i+2,j,k)*(-0.5)
     & + Gamty(i+3,j,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Gamt(1,2) = (
     & + Gamty(i-3,j,k)*(-0.0833333333333333)
     & + Gamty(i-2,j,k)*(0.5)
     & + Gamty(i-1,j,k)*(-1.5)
     & + Gamty(i,j,k)*(0.833333333333333)
     & + Gamty(i+1,j,k)*(0.25)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_Gamt(2,2) = (
     & + Gamty(i,j-1,k)*(-0.25)
     & + Gamty(i,j,k)*(-0.833333333333333)
     & + Gamty(i,j+1,k)*(1.5)
     & + Gamty(i,j+2,k)*(-0.5)
     & + Gamty(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Gamt(2,2) = (
     & + Gamty(i,j-3,k)*(-0.0833333333333333)
     & + Gamty(i,j-2,k)*(0.5)
     & + Gamty(i,j-1,k)*(-1.5)
     & + Gamty(i,j,k)*(0.833333333333333)
     & + Gamty(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_Gamt(3,2) = (
     & + Gamty(i,j,k-1)*(-0.25)
     & + Gamty(i,j,k)*(-0.833333333333333)
     & + Gamty(i,j,k+1)*(1.5)
     & + Gamty(i,j,k+2)*(-0.5)
     & + Gamty(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Gamt(3,2) = (
     & + Gamty(i,j,k-3)*(-0.0833333333333333)
     & + Gamty(i,j,k-2)*(0.5)
     & + Gamty(i,j,k-1)*(-1.5)
     & + Gamty(i,j,k)*(0.833333333333333)
     & + Gamty(i,j,k+1)*(0.25)
     & )*idx
        end if
        Gamt(3) = Gamtz(i,j,k)
        d_Gamt(1,3) = (
     & + Gamtz(i-2,j,k)*(0.0833333333333333)
     & + Gamtz(i-1,j,k)*(-0.666666666666667)
     & + Gamtz(i+1,j,k)*(0.666666666666667)
     & + Gamtz(i+2,j,k)*(-0.0833333333333333)
     & )*idx
        d_Gamt(2,3) = (
     & + Gamtz(i,j-2,k)*(0.0833333333333333)
     & + Gamtz(i,j-1,k)*(-0.666666666666667)
     & + Gamtz(i,j+1,k)*(0.666666666666667)
     & + Gamtz(i,j+2,k)*(-0.0833333333333333)
     & )*idx
        d_Gamt(3,3) = (
     & + Gamtz(i,j,k-2)*(0.0833333333333333)
     & + Gamtz(i,j,k-1)*(-0.666666666666667)
     & + Gamtz(i,j,k+1)*(0.666666666666667)
     & + Gamtz(i,j,k+2)*(-0.0833333333333333)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_Gamt(1,3) = (
     & + Gamtz(i-1,j,k)*(-0.25)
     & + Gamtz(i  ,j,k)*(-0.833333333333333)
     & + Gamtz(i+1,j,k)*(1.5)
     & + Gamtz(i+2,j,k)*(-0.5)
     & + Gamtz(i+3,j,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Gamt(1,3) = (
     & + Gamtz(i-3,j,k)*(-0.0833333333333333)
     & + Gamtz(i-2,j,k)*(0.5)
     & + Gamtz(i-1,j,k)*(-1.5)
     & + Gamtz(i,j,k)*(0.833333333333333)
     & + Gamtz(i+1,j,k)*(0.25)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_Gamt(2,3) = (
     & + Gamtz(i,j-1,k)*(-0.25)
     & + Gamtz(i,j,k)*(-0.833333333333333)
     & + Gamtz(i,j+1,k)*(1.5)
     & + Gamtz(i,j+2,k)*(-0.5)
     & + Gamtz(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Gamt(2,3) = (
     & + Gamtz(i,j-3,k)*(-0.0833333333333333)
     & + Gamtz(i,j-2,k)*(0.5)
     & + Gamtz(i,j-1,k)*(-1.5)
     & + Gamtz(i,j,k)*(0.833333333333333)
     & + Gamtz(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_Gamt(3,3) = (
     & + Gamtz(i,j,k-1)*(-0.25)
     & + Gamtz(i,j,k)*(-0.833333333333333)
     & + Gamtz(i,j,k+1)*(1.5)
     & + Gamtz(i,j,k+2)*(-0.5)
     & + Gamtz(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Gamt(3,3) = (
     & + Gamtz(i,j,k-3)*(-0.0833333333333333)
     & + Gamtz(i,j,k-2)*(0.5)
     & + Gamtz(i,j,k-1)*(-1.5)
     & + Gamtz(i,j,k)*(0.833333333333333)
     & + Gamtz(i,j,k+1)*(0.25)
     & )*idx
        end if
        Alpha = Alpha3D(i,j,k)
        d_Alpha(1) = (
     & + Alpha3D(i-2,j,k)*(0.0833333333333333d0)
     & + Alpha3D(i-1,j,k)*(-0.666666666666667d0)
     & + Alpha3D(i+1,j,k)*(0.666666666666667d0)
     & + Alpha3D(i+2,j,k)*(-0.0833333333333333d0)
     & )*idx
        d_Alpha(2) = (
     & + Alpha3D(i,j-2,k)*(0.0833333333333333d0)
     & + Alpha3D(i,j-1,k)*(-0.666666666666667d0)
     & + Alpha3D(i,j+1,k)*(0.666666666666667d0)
     & + Alpha3D(i,j+2,k)*(-0.0833333333333333d0)
     & )*idx
        d_Alpha(3) = (
     & + Alpha3D(i,j,k-2)*(0.0833333333333333d0)
     & + Alpha3D(i,j,k-1)*(-0.666666666666667d0)
     & + Alpha3D(i,j,k+1)*(0.666666666666667d0)
     & + Alpha3D(i,j,k+2)*(-0.0833333333333333d0)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_Alpha(1) = (
     & + Alpha3D(i-1,j,k)*(-0.25d0)
     & + Alpha3D(i,j,k)*(-0.833333333333333d0)
     & + Alpha3D(i+1,j,k)*(1.5d0)
     & + Alpha3D(i+2,j,k)*(-0.5d0)
     & + Alpha3D(i+3,j,k)*(0.0833333333333333d0)
     & )*idx
        else
        adv_d_Alpha(1) = (
     & + Alpha3D(i-3,j,k)*(-0.0833333333333333d0)
     & + Alpha3D(i-2,j,k)*(0.5d0)
     & + Alpha3D(i-1,j,k)*(-1.5d0)
     & + Alpha3D(i  ,j,k)*(0.833333333333333d0)
     & + Alpha3D(i+1,j,k)*(0.25d0)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_Alpha(2) = (
     & + Alpha3D(i,j-1,k)*(-0.25)
     & + Alpha3D(i,j  ,k)*(-0.833333333333333)
     & + Alpha3D(i,j+1,k)*(1.5)
     & + Alpha3D(i,j+2,k)*(-0.5)
     & + Alpha3D(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Alpha(2) = (
     & + Alpha3D(i,j-3,k)*(-0.0833333333333333)
     & + Alpha3D(i,j-2,k)*(0.5)
     & + Alpha3D(i,j-1,k)*(-1.5)
     & + Alpha3D(i,j  ,k)*(0.833333333333333)
     & + Alpha3D(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_Alpha(3) = (
     & + Alpha3D(i,j,k-1)*(-0.25)
     & + Alpha3D(i,j,k)*(-0.833333333333333)
     & + Alpha3D(i,j,k+1)*(1.5)
     & + Alpha3D(i,j,k+2)*(-0.5)
     & + Alpha3D(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Alpha(3) = (
     & + Alpha3D(i,j,k-3)*(-0.0833333333333333)
     & + Alpha3D(i,j,k-2)*(0.5)
     & + Alpha3D(i,j,k-1)*(-1.5)
     & + Alpha3D(i,j,k)*(0.833333333333333)
     & + Alpha3D(i,j,k+1)*(0.25)
     & )*idx
        end if
        dd_Alpha(1,1) = (
     & + Alpha3D(i-2,j,k)*(-0.0833333333333333)
     & + Alpha3D(i-1,j,k)*(1.33333333333333)
     & + Alpha3D(i,j,k)*(-2.5)
     & + Alpha3D(i+1,j,k)*(1.33333333333333)
     & + Alpha3D(i+2,j,k)*(-0.0833333333333333)
     & )*idxsq
        dd_Alpha(2,2) = (
     & + Alpha3D(i,j-2,k)*(-0.0833333333333333)
     & + Alpha3D(i,j-1,k)*(1.33333333333333)
     & + Alpha3D(i,j,k)*(-2.5)
     & + Alpha3D(i,j+1,k)*(1.33333333333333)
     & + Alpha3D(i,j+2,k)*(-0.0833333333333333)
     & )*idxsq
        dd_Alpha(3,3) = (
     & + Alpha3D(i,j,k-2)*(-0.0833333333333333)
     & + Alpha3D(i,j,k-1)*(1.33333333333333)
     & + Alpha3D(i,j,k)*(-2.5)
     & + Alpha3D(i,j,k+1)*(1.33333333333333)
     & + Alpha3D(i,j,k+2)*(-0.0833333333333333)
     & )*idxsq
        dd_Alpha(1,2) = (
     & + Alpha3D(i-2,j-2,k)*(0.00694444444444444)
     & + Alpha3D(i-2,j-1,k)*(-0.0555555555555556)
     & + Alpha3D(i-2,j+1,k)*(0.0555555555555556)
     & + Alpha3D(i-2,j+2,k)*(-0.00694444444444444)
     & + Alpha3D(i-1,j-2,k)*(-0.0555555555555556)
     & + Alpha3D(i-1,j-1,k)*(0.444444444444444)
     & + Alpha3D(i-1,j+1,k)*(-0.444444444444444)
     & + Alpha3D(i-1,j+2,k)*(0.0555555555555556)
     & + Alpha3D(i+1,j-2,k)*(0.0555555555555556)
     & + Alpha3D(i+1,j-1,k)*(-0.444444444444444)
     & + Alpha3D(i+1,j+1,k)*(0.444444444444444)
     & + Alpha3D(i+1,j+2,k)*(-0.0555555555555556)
     & + Alpha3D(i+2,j-2,k)*(-0.00694444444444444)
     & + Alpha3D(i+2,j-1,k)*(0.0555555555555556)
     & + Alpha3D(i+2,j+1,k)*(-0.0555555555555556)
     & + Alpha3D(i+2,j+2,k)*(0.00694444444444444)
     & )*idxsq
        dd_Alpha(1,3) = (
     & + Alpha3D(i-2,j,k-2)*(0.00694444444444444)
     & + Alpha3D(i-2,j,k-1)*(-0.0555555555555556)
     & + Alpha3D(i-2,j,k+1)*(0.0555555555555556)
     & + Alpha3D(i-2,j,k+2)*(-0.00694444444444444)
     & + Alpha3D(i-1,j,k-2)*(-0.0555555555555556)
     & + Alpha3D(i-1,j,k-1)*(0.444444444444444)
     & + Alpha3D(i-1,j,k+1)*(-0.444444444444444)
     & + Alpha3D(i-1,j,k+2)*(0.0555555555555556)
     & + Alpha3D(i+1,j,k-2)*(0.0555555555555556)
     & + Alpha3D(i+1,j,k-1)*(-0.444444444444444)
     & + Alpha3D(i+1,j,k+1)*(0.444444444444444)
     & + Alpha3D(i+1,j,k+2)*(-0.0555555555555556)
     & + Alpha3D(i+2,j,k-2)*(-0.00694444444444444)
     & + Alpha3D(i+2,j,k-1)*(0.0555555555555556)
     & + Alpha3D(i+2,j,k+1)*(-0.0555555555555556)
     & + Alpha3D(i+2,j,k+2)*(0.00694444444444444)
     & )*idxsq
        dd_Alpha(2,3) = (
     & + Alpha3D(i,j-2,k-2)*(0.00694444444444444)
     & + Alpha3D(i,j-2,k-1)*(-0.0555555555555556)
     & + Alpha3D(i,j-2,k+1)*(0.0555555555555556)
     & + Alpha3D(i,j-2,k+2)*(-0.00694444444444444)
     & + Alpha3D(i,j-1,k-2)*(-0.0555555555555556)
     & + Alpha3D(i,j-1,k-1)*(0.444444444444444)
     & + Alpha3D(i,j-1,k+1)*(-0.444444444444444)
     & + Alpha3D(i,j-1,k+2)*(0.0555555555555556)
     & + Alpha3D(i,j+1,k-2)*(0.0555555555555556)
     & + Alpha3D(i,j+1,k-1)*(-0.444444444444444)
     & + Alpha3D(i,j+1,k+1)*(0.444444444444444)
     & + Alpha3D(i,j+1,k+2)*(-0.0555555555555556)
     & + Alpha3D(i,j+2,k-2)*(-0.00694444444444444)
     & + Alpha3D(i,j+2,k-1)*(0.0555555555555556)
     & + Alpha3D(i,j+2,k+1)*(-0.0555555555555556)
     & + Alpha3D(i,j+2,k+2)*(0.00694444444444444)
     & )*idxsq
        Betau(1) = shiftx(i,j,k)
        d_Betau(1,1) = (
     & + shiftx(i-2,j,k)*(0.0833333333333333d0)
     & + shiftx(i-1,j,k)*(-0.666666666666667d0)
     & + shiftx(i+1,j,k)*(0.666666666666667d0)
     & + shiftx(i+2,j,k)*(-0.0833333333333333d0)
     & )*idx
        d_Betau(2,1) = (
     & + shiftx(i,j-2,k)*(0.0833333333333333d0)
     & + shiftx(i,j-1,k)*(-0.666666666666667d0)
     & + shiftx(i,j+1,k)*(0.666666666666667d0)
     & + shiftx(i,j+2,k)*(-0.0833333333333333d0)
     & )*idx
        d_Betau(3,1) = (
     & + shiftx(i,j,k-2)*(0.0833333333333333d0)
     & + shiftx(i,j,k-1)*(-0.666666666666667d0)
     & + shiftx(i,j,k+1)*(0.666666666666667d0)
     & + shiftx(i,j,k+2)*(-0.0833333333333333d0)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_Betau(1,1) = (
     & + shiftx(i-1,j,k)*(-0.25d0)
     & + shiftx(i,j,k)*(-0.833333333333333d0)
     & + shiftx(i+1,j,k)*(1.5d0)
     & + shiftx(i+2,j,k)*(-0.5d0)
     & + shiftx(i+3,j,k)*(0.0833333333333333d0)
     & )*idx
        else
        adv_d_Betau(1,1) = (
     & + shiftx(i-3,j,k)*(-0.0833333333333333d0)
     & + shiftx(i-2,j,k)*(0.5d0)
     & + shiftx(i-1,j,k)*(-1.5d0)
     & + shiftx(i  ,j,k)*(0.833333333333333d0)
     & + shiftx(i+1,j,k)*(0.25d0)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_Betau(2,1) = (
     & + shiftx(i,j-1,k)*(-0.25)
     & + shiftx(i,j  ,k)*(-0.833333333333333)
     & + shiftx(i,j+1,k)*(1.5)
     & + shiftx(i,j+2,k)*(-0.5)
     & + shiftx(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Betau(2,1) = (
     & + shiftx(i,j-3,k)*(-0.0833333333333333)
     & + shiftx(i,j-2,k)*(0.5)
     & + shiftx(i,j-1,k)*(-1.5)
     & + shiftx(i,j  ,k)*(0.833333333333333)
     & + shiftx(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_Betau(3,1) = (
     & + shiftx(i,j,k-1)*(-0.25)
     & + shiftx(i,j,k)*(-0.833333333333333)
     & + shiftx(i,j,k+1)*(1.5)
     & + shiftx(i,j,k+2)*(-0.5)
     & + shiftx(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Betau(3,1) = (
     & + shiftx(i,j,k-3)*(-0.0833333333333333)
     & + shiftx(i,j,k-2)*(0.5)
     & + shiftx(i,j,k-1)*(-1.5)
     & + shiftx(i,j,k)*(0.833333333333333)
     & + shiftx(i,j,k+1)*(0.25)
     & )*idx
        end if
        dd_Betau(1,1,1) = (
     & + shiftx(i-2,j,k)*(-0.0833333333333333)
     & + shiftx(i-1,j,k)*(1.33333333333333)
     & + shiftx(i,j,k)*(-2.5)
     & + shiftx(i+1,j,k)*(1.33333333333333)
     & + shiftx(i+2,j,k)*(-0.0833333333333333)
     & )*idxsq
        dd_Betau(2,2,1) = (
     & + shiftx(i,j-2,k)*(-0.0833333333333333)
     & + shiftx(i,j-1,k)*(1.33333333333333)
     & + shiftx(i,j,k)*(-2.5)
     & + shiftx(i,j+1,k)*(1.33333333333333)
     & + shiftx(i,j+2,k)*(-0.0833333333333333)
     & )*idxsq
        dd_Betau(3,3,1) = (
     & + shiftx(i,j,k-2)*(-0.0833333333333333)
     & + shiftx(i,j,k-1)*(1.33333333333333)
     & + shiftx(i,j,k)*(-2.5)
     & + shiftx(i,j,k+1)*(1.33333333333333)
     & + shiftx(i,j,k+2)*(-0.0833333333333333)
     & )*idxsq
        dd_Betau(1,2,1) = (
     & + shiftx(i-2,j-2,k)*(0.00694444444444444)
     & + shiftx(i-2,j-1,k)*(-0.0555555555555556)
     & + shiftx(i-2,j+1,k)*(0.0555555555555556)
     & + shiftx(i-2,j+2,k)*(-0.00694444444444444)
     & + shiftx(i-1,j-2,k)*(-0.0555555555555556)
     & + shiftx(i-1,j-1,k)*(0.444444444444444)
     & + shiftx(i-1,j+1,k)*(-0.444444444444444)
     & + shiftx(i-1,j+2,k)*(0.0555555555555556)
     & + shiftx(i+1,j-2,k)*(0.0555555555555556)
     & + shiftx(i+1,j-1,k)*(-0.444444444444444)
     & + shiftx(i+1,j+1,k)*(0.444444444444444)
     & + shiftx(i+1,j+2,k)*(-0.0555555555555556)
     & + shiftx(i+2,j-2,k)*(-0.00694444444444444)
     & + shiftx(i+2,j-1,k)*(0.0555555555555556)
     & + shiftx(i+2,j+1,k)*(-0.0555555555555556)
     & + shiftx(i+2,j+2,k)*(0.00694444444444444)
     & )*idxsq
        dd_Betau(1,3,1) = (
     & + shiftx(i-2,j,k-2)*(0.00694444444444444)
     & + shiftx(i-2,j,k-1)*(-0.0555555555555556)
     & + shiftx(i-2,j,k+1)*(0.0555555555555556)
     & + shiftx(i-2,j,k+2)*(-0.00694444444444444)
     & + shiftx(i-1,j,k-2)*(-0.0555555555555556)
     & + shiftx(i-1,j,k-1)*(0.444444444444444)
     & + shiftx(i-1,j,k+1)*(-0.444444444444444)
     & + shiftx(i-1,j,k+2)*(0.0555555555555556)
     & + shiftx(i+1,j,k-2)*(0.0555555555555556)
     & + shiftx(i+1,j,k-1)*(-0.444444444444444)
     & + shiftx(i+1,j,k+1)*(0.444444444444444)
     & + shiftx(i+1,j,k+2)*(-0.0555555555555556)
     & + shiftx(i+2,j,k-2)*(-0.00694444444444444)
     & + shiftx(i+2,j,k-1)*(0.0555555555555556)
     & + shiftx(i+2,j,k+1)*(-0.0555555555555556)
     & + shiftx(i+2,j,k+2)*(0.00694444444444444)
     & )*idxsq
        dd_Betau(2,3,1) = (
     & + shiftx(i,j-2,k-2)*(0.00694444444444444)
     & + shiftx(i,j-2,k-1)*(-0.0555555555555556)
     & + shiftx(i,j-2,k+1)*(0.0555555555555556)
     & + shiftx(i,j-2,k+2)*(-0.00694444444444444)
     & + shiftx(i,j-1,k-2)*(-0.0555555555555556)
     & + shiftx(i,j-1,k-1)*(0.444444444444444)
     & + shiftx(i,j-1,k+1)*(-0.444444444444444)
     & + shiftx(i,j-1,k+2)*(0.0555555555555556)
     & + shiftx(i,j+1,k-2)*(0.0555555555555556)
     & + shiftx(i,j+1,k-1)*(-0.444444444444444)
     & + shiftx(i,j+1,k+1)*(0.444444444444444)
     & + shiftx(i,j+1,k+2)*(-0.0555555555555556)
     & + shiftx(i,j+2,k-2)*(-0.00694444444444444)
     & + shiftx(i,j+2,k-1)*(0.0555555555555556)
     & + shiftx(i,j+2,k+1)*(-0.0555555555555556)
     & + shiftx(i,j+2,k+2)*(0.00694444444444444)
     & )*idxsq
        Betau(2) = shifty(i,j,k)
        d_Betau(1,2) = (
     & + shifty(i-2,j,k)*(0.0833333333333333d0)
     & + shifty(i-1,j,k)*(-0.666666666666667d0)
     & + shifty(i+1,j,k)*(0.666666666666667d0)
     & + shifty(i+2,j,k)*(-0.0833333333333333d0)
     & )*idx
        d_Betau(2,2) = (
     & + shifty(i,j-2,k)*(0.0833333333333333d0)
     & + shifty(i,j-1,k)*(-0.666666666666667d0)
     & + shifty(i,j+1,k)*(0.666666666666667d0)
     & + shifty(i,j+2,k)*(-0.0833333333333333d0)
     & )*idx
        d_Betau(3,2) = (
     & + shifty(i,j,k-2)*(0.0833333333333333d0)
     & + shifty(i,j,k-1)*(-0.666666666666667d0)
     & + shifty(i,j,k+1)*(0.666666666666667d0)
     & + shifty(i,j,k+2)*(-0.0833333333333333d0)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_Betau(1,2) = (
     & + shifty(i-1,j,k)*(-0.25d0)
     & + shifty(i,j,k)*(-0.833333333333333d0)
     & + shifty(i+1,j,k)*(1.5d0)
     & + shifty(i+2,j,k)*(-0.5d0)
     & + shifty(i+3,j,k)*(0.0833333333333333d0)
     & )*idx
        else
        adv_d_Betau(1,2) = (
     & + shifty(i-3,j,k)*(-0.0833333333333333d0)
     & + shifty(i-2,j,k)*(0.5d0)
     & + shifty(i-1,j,k)*(-1.5d0)
     & + shifty(i  ,j,k)*(0.833333333333333d0)
     & + shifty(i+1,j,k)*(0.25d0)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_Betau(2,2) = (
     & + shifty(i,j-1,k)*(-0.25)
     & + shifty(i,j  ,k)*(-0.833333333333333)
     & + shifty(i,j+1,k)*(1.5)
     & + shifty(i,j+2,k)*(-0.5)
     & + shifty(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Betau(2,2) = (
     & + shifty(i,j-3,k)*(-0.0833333333333333)
     & + shifty(i,j-2,k)*(0.5)
     & + shifty(i,j-1,k)*(-1.5)
     & + shifty(i,j  ,k)*(0.833333333333333)
     & + shifty(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_Betau(3,2) = (
     & + shifty(i,j,k-1)*(-0.25)
     & + shifty(i,j,k)*(-0.833333333333333)
     & + shifty(i,j,k+1)*(1.5)
     & + shifty(i,j,k+2)*(-0.5)
     & + shifty(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Betau(3,2) = (
     & + shifty(i,j,k-3)*(-0.0833333333333333)
     & + shifty(i,j,k-2)*(0.5)
     & + shifty(i,j,k-1)*(-1.5)
     & + shifty(i,j,k)*(0.833333333333333)
     & + shifty(i,j,k+1)*(0.25)
     & )*idx
        end if
        dd_Betau(1,1,2) = (
     & + shifty(i-2,j,k)*(-0.0833333333333333)
     & + shifty(i-1,j,k)*(1.33333333333333)
     & + shifty(i,j,k)*(-2.5)
     & + shifty(i+1,j,k)*(1.33333333333333)
     & + shifty(i+2,j,k)*(-0.0833333333333333)
     & )*idxsq
        dd_Betau(2,2,2) = (
     & + shifty(i,j-2,k)*(-0.0833333333333333)
     & + shifty(i,j-1,k)*(1.33333333333333)
     & + shifty(i,j,k)*(-2.5)
     & + shifty(i,j+1,k)*(1.33333333333333)
     & + shifty(i,j+2,k)*(-0.0833333333333333)
     & )*idxsq
        dd_Betau(3,3,2) = (
     & + shifty(i,j,k-2)*(-0.0833333333333333)
     & + shifty(i,j,k-1)*(1.33333333333333)
     & + shifty(i,j,k)*(-2.5)
     & + shifty(i,j,k+1)*(1.33333333333333)
     & + shifty(i,j,k+2)*(-0.0833333333333333)
     & )*idxsq
        dd_Betau(1,2,2) = (
     & + shifty(i-2,j-2,k)*(0.00694444444444444)
     & + shifty(i-2,j-1,k)*(-0.0555555555555556)
     & + shifty(i-2,j+1,k)*(0.0555555555555556)
     & + shifty(i-2,j+2,k)*(-0.00694444444444444)
     & + shifty(i-1,j-2,k)*(-0.0555555555555556)
     & + shifty(i-1,j-1,k)*(0.444444444444444)
     & + shifty(i-1,j+1,k)*(-0.444444444444444)
     & + shifty(i-1,j+2,k)*(0.0555555555555556)
     & + shifty(i+1,j-2,k)*(0.0555555555555556)
     & + shifty(i+1,j-1,k)*(-0.444444444444444)
     & + shifty(i+1,j+1,k)*(0.444444444444444)
     & + shifty(i+1,j+2,k)*(-0.0555555555555556)
     & + shifty(i+2,j-2,k)*(-0.00694444444444444)
     & + shifty(i+2,j-1,k)*(0.0555555555555556)
     & + shifty(i+2,j+1,k)*(-0.0555555555555556)
     & + shifty(i+2,j+2,k)*(0.00694444444444444)
     & )*idxsq
        dd_Betau(1,3,2) = (
     & + shifty(i-2,j,k-2)*(0.00694444444444444)
     & + shifty(i-2,j,k-1)*(-0.0555555555555556)
     & + shifty(i-2,j,k+1)*(0.0555555555555556)
     & + shifty(i-2,j,k+2)*(-0.00694444444444444)
     & + shifty(i-1,j,k-2)*(-0.0555555555555556)
     & + shifty(i-1,j,k-1)*(0.444444444444444)
     & + shifty(i-1,j,k+1)*(-0.444444444444444)
     & + shifty(i-1,j,k+2)*(0.0555555555555556)
     & + shifty(i+1,j,k-2)*(0.0555555555555556)
     & + shifty(i+1,j,k-1)*(-0.444444444444444)
     & + shifty(i+1,j,k+1)*(0.444444444444444)
     & + shifty(i+1,j,k+2)*(-0.0555555555555556)
     & + shifty(i+2,j,k-2)*(-0.00694444444444444)
     & + shifty(i+2,j,k-1)*(0.0555555555555556)
     & + shifty(i+2,j,k+1)*(-0.0555555555555556)
     & + shifty(i+2,j,k+2)*(0.00694444444444444)
     & )*idxsq
        dd_Betau(2,3,2) = (
     & + shifty(i,j-2,k-2)*(0.00694444444444444)
     & + shifty(i,j-2,k-1)*(-0.0555555555555556)
     & + shifty(i,j-2,k+1)*(0.0555555555555556)
     & + shifty(i,j-2,k+2)*(-0.00694444444444444)
     & + shifty(i,j-1,k-2)*(-0.0555555555555556)
     & + shifty(i,j-1,k-1)*(0.444444444444444)
     & + shifty(i,j-1,k+1)*(-0.444444444444444)
     & + shifty(i,j-1,k+2)*(0.0555555555555556)
     & + shifty(i,j+1,k-2)*(0.0555555555555556)
     & + shifty(i,j+1,k-1)*(-0.444444444444444)
     & + shifty(i,j+1,k+1)*(0.444444444444444)
     & + shifty(i,j+1,k+2)*(-0.0555555555555556)
     & + shifty(i,j+2,k-2)*(-0.00694444444444444)
     & + shifty(i,j+2,k-1)*(0.0555555555555556)
     & + shifty(i,j+2,k+1)*(-0.0555555555555556)
     & + shifty(i,j+2,k+2)*(0.00694444444444444)
     & )*idxsq
        Betau(3) = shiftz(i,j,k)
        d_Betau(1,3) = (
     & + shiftz(i-2,j,k)*(0.0833333333333333d0)
     & + shiftz(i-1,j,k)*(-0.666666666666667d0)
     & + shiftz(i+1,j,k)*(0.666666666666667d0)
     & + shiftz(i+2,j,k)*(-0.0833333333333333d0)
     & )*idx
        d_Betau(2,3) = (
     & + shiftz(i,j-2,k)*(0.0833333333333333d0)
     & + shiftz(i,j-1,k)*(-0.666666666666667d0)
     & + shiftz(i,j+1,k)*(0.666666666666667d0)
     & + shiftz(i,j+2,k)*(-0.0833333333333333d0)
     & )*idx
        d_Betau(3,3) = (
     & + shiftz(i,j,k-2)*(0.0833333333333333d0)
     & + shiftz(i,j,k-1)*(-0.666666666666667d0)
     & + shiftz(i,j,k+1)*(0.666666666666667d0)
     & + shiftz(i,j,k+2)*(-0.0833333333333333d0)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_Betau(1,3) = (
     & + shiftz(i-1,j,k)*(-0.25d0)
     & + shiftz(i,j,k)*(-0.833333333333333d0)
     & + shiftz(i+1,j,k)*(1.5d0)
     & + shiftz(i+2,j,k)*(-0.5d0)
     & + shiftz(i+3,j,k)*(0.0833333333333333d0)
     & )*idx
        else
        adv_d_Betau(1,3) = (
     & + shiftz(i-3,j,k)*(-0.0833333333333333d0)
     & + shiftz(i-2,j,k)*(0.5d0)
     & + shiftz(i-1,j,k)*(-1.5d0)
     & + shiftz(i  ,j,k)*(0.833333333333333d0)
     & + shiftz(i+1,j,k)*(0.25d0)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_Betau(2,3) = (
     & + shiftz(i,j-1,k)*(-0.25)
     & + shiftz(i,j  ,k)*(-0.833333333333333)
     & + shiftz(i,j+1,k)*(1.5)
     & + shiftz(i,j+2,k)*(-0.5)
     & + shiftz(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Betau(2,3) = (
     & + shiftz(i,j-3,k)*(-0.0833333333333333)
     & + shiftz(i,j-2,k)*(0.5)
     & + shiftz(i,j-1,k)*(-1.5)
     & + shiftz(i,j  ,k)*(0.833333333333333)
     & + shiftz(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_Betau(3,3) = (
     & + shiftz(i,j,k-1)*(-0.25)
     & + shiftz(i,j,k)*(-0.833333333333333)
     & + shiftz(i,j,k+1)*(1.5)
     & + shiftz(i,j,k+2)*(-0.5)
     & + shiftz(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Betau(3,3) = (
     & + shiftz(i,j,k-3)*(-0.0833333333333333)
     & + shiftz(i,j,k-2)*(0.5)
     & + shiftz(i,j,k-1)*(-1.5)
     & + shiftz(i,j,k)*(0.833333333333333)
     & + shiftz(i,j,k+1)*(0.25)
     & )*idx
        end if
        dd_Betau(1,1,3) = (
     & + shiftz(i-2,j,k)*(-0.0833333333333333)
     & + shiftz(i-1,j,k)*(1.33333333333333)
     & + shiftz(i,j,k)*(-2.5)
     & + shiftz(i+1,j,k)*(1.33333333333333)
     & + shiftz(i+2,j,k)*(-0.0833333333333333)
     & )*idxsq
        dd_Betau(2,2,3) = (
     & + shiftz(i,j-2,k)*(-0.0833333333333333)
     & + shiftz(i,j-1,k)*(1.33333333333333)
     & + shiftz(i,j,k)*(-2.5)
     & + shiftz(i,j+1,k)*(1.33333333333333)
     & + shiftz(i,j+2,k)*(-0.0833333333333333)
     & )*idxsq
        dd_Betau(3,3,3) = (
     & + shiftz(i,j,k-2)*(-0.0833333333333333)
     & + shiftz(i,j,k-1)*(1.33333333333333)
     & + shiftz(i,j,k)*(-2.5)
     & + shiftz(i,j,k+1)*(1.33333333333333)
     & + shiftz(i,j,k+2)*(-0.0833333333333333)
     & )*idxsq
        dd_Betau(1,2,3) = (
     & + shiftz(i-2,j-2,k)*(0.00694444444444444)
     & + shiftz(i-2,j-1,k)*(-0.0555555555555556)
     & + shiftz(i-2,j+1,k)*(0.0555555555555556)
     & + shiftz(i-2,j+2,k)*(-0.00694444444444444)
     & + shiftz(i-1,j-2,k)*(-0.0555555555555556)
     & + shiftz(i-1,j-1,k)*(0.444444444444444)
     & + shiftz(i-1,j+1,k)*(-0.444444444444444)
     & + shiftz(i-1,j+2,k)*(0.0555555555555556)
     & + shiftz(i+1,j-2,k)*(0.0555555555555556)
     & + shiftz(i+1,j-1,k)*(-0.444444444444444)
     & + shiftz(i+1,j+1,k)*(0.444444444444444)
     & + shiftz(i+1,j+2,k)*(-0.0555555555555556)
     & + shiftz(i+2,j-2,k)*(-0.00694444444444444)
     & + shiftz(i+2,j-1,k)*(0.0555555555555556)
     & + shiftz(i+2,j+1,k)*(-0.0555555555555556)
     & + shiftz(i+2,j+2,k)*(0.00694444444444444)
     & )*idxsq
        dd_Betau(1,3,3) = (
     & + shiftz(i-2,j,k-2)*(0.00694444444444444)
     & + shiftz(i-2,j,k-1)*(-0.0555555555555556)
     & + shiftz(i-2,j,k+1)*(0.0555555555555556)
     & + shiftz(i-2,j,k+2)*(-0.00694444444444444)
     & + shiftz(i-1,j,k-2)*(-0.0555555555555556)
     & + shiftz(i-1,j,k-1)*(0.444444444444444)
     & + shiftz(i-1,j,k+1)*(-0.444444444444444)
     & + shiftz(i-1,j,k+2)*(0.0555555555555556)
     & + shiftz(i+1,j,k-2)*(0.0555555555555556)
     & + shiftz(i+1,j,k-1)*(-0.444444444444444)
     & + shiftz(i+1,j,k+1)*(0.444444444444444)
     & + shiftz(i+1,j,k+2)*(-0.0555555555555556)
     & + shiftz(i+2,j,k-2)*(-0.00694444444444444)
     & + shiftz(i+2,j,k-1)*(0.0555555555555556)
     & + shiftz(i+2,j,k+1)*(-0.0555555555555556)
     & + shiftz(i+2,j,k+2)*(0.00694444444444444)
     & )*idxsq
        dd_Betau(2,3,3) = (
     & + shiftz(i,j-2,k-2)*(0.00694444444444444)
     & + shiftz(i,j-2,k-1)*(-0.0555555555555556)
     & + shiftz(i,j-2,k+1)*(0.0555555555555556)
     & + shiftz(i,j-2,k+2)*(-0.00694444444444444)
     & + shiftz(i,j-1,k-2)*(-0.0555555555555556)
     & + shiftz(i,j-1,k-1)*(0.444444444444444)
     & + shiftz(i,j-1,k+1)*(-0.444444444444444)
     & + shiftz(i,j-1,k+2)*(0.0555555555555556)
     & + shiftz(i,j+1,k-2)*(0.0555555555555556)
     & + shiftz(i,j+1,k-1)*(-0.444444444444444)
     & + shiftz(i,j+1,k+1)*(0.444444444444444)
     & + shiftz(i,j+1,k+2)*(-0.0555555555555556)
     & + shiftz(i,j+2,k-2)*(-0.00694444444444444)
     & + shiftz(i,j+2,k-1)*(0.0555555555555556)
     & + shiftz(i,j+2,k+1)*(-0.0555555555555556)
     & + shiftz(i,j+2,k+2)*(0.00694444444444444)
     & )*idxsq
        Bu(1) = gbx(i,j,k)
        d_Bu(1,1) = (
     & + gbx(i-2,j,k)*(0.0833333333333333)
     & + gbx(i-1,j,k)*(-0.666666666666667)
     & + gbx(i+1,j,k)*(0.666666666666667)
     & + gbx(i+2,j,k)*(-0.0833333333333333)
     & )*idx
        d_Bu(2,1) = (
     & + gbx(i,j-2,k)*(0.0833333333333333)
     & + gbx(i,j-1,k)*(-0.666666666666667)
     & + gbx(i,j+1,k)*(0.666666666666667)
     & + gbx(i,j+2,k)*(-0.0833333333333333)
     & )*idx
        d_Bu(3,1) = (
     & + gbx(i,j,k-2)*(0.0833333333333333)
     & + gbx(i,j,k-1)*(-0.666666666666667)
     & + gbx(i,j,k+1)*(0.666666666666667)
     & + gbx(i,j,k+2)*(-0.0833333333333333)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_Bu(1,1) = (
     & + gbx(i-1,j,k)*(-0.25)
     & + gbx(i  ,j,k)*(-0.833333333333333)
     & + gbx(i+1,j,k)*(1.5)
     & + gbx(i+2,j,k)*(-0.5)
     & + gbx(i+3,j,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Bu(1,1) = (
     & + gbx(i-3,j,k)*(-0.0833333333333333)
     & + gbx(i-2,j,k)*(0.5)
     & + gbx(i-1,j,k)*(-1.5)
     & + gbx(i,j,k)*(0.833333333333333)
     & + gbx(i+1,j,k)*(0.25)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_Bu(2,1) = (
     & + gbx(i,j-1,k)*(-0.25)
     & + gbx(i,j,k)*(-0.833333333333333)
     & + gbx(i,j+1,k)*(1.5)
     & + gbx(i,j+2,k)*(-0.5)
     & + gbx(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Bu(2,1) = (
     & + gbx(i,j-3,k)*(-0.0833333333333333)
     & + gbx(i,j-2,k)*(0.5)
     & + gbx(i,j-1,k)*(-1.5)
     & + gbx(i,j,k)*(0.833333333333333)
     & + gbx(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_Bu(3,1) = (
     & + gbx(i,j,k-1)*(-0.25)
     & + gbx(i,j,k)*(-0.833333333333333)
     & + gbx(i,j,k+1)*(1.5)
     & + gbx(i,j,k+2)*(-0.5)
     & + gbx(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Bu(3,1) = (
     & + gbx(i,j,k-3)*(-0.0833333333333333)
     & + gbx(i,j,k-2)*(0.5)
     & + gbx(i,j,k-1)*(-1.5)
     & + gbx(i,j,k)*(0.833333333333333)
     & + gbx(i,j,k+1)*(0.25)
     & )*idx
        end if
        Bu(2) = gby(i,j,k)
        d_Bu(1,2) = (
     & + gby(i-2,j,k)*(0.0833333333333333)
     & + gby(i-1,j,k)*(-0.666666666666667)
     & + gby(i+1,j,k)*(0.666666666666667)
     & + gby(i+2,j,k)*(-0.0833333333333333)
     & )*idx
        d_Bu(2,2) = (
     & + gby(i,j-2,k)*(0.0833333333333333)
     & + gby(i,j-1,k)*(-0.666666666666667)
     & + gby(i,j+1,k)*(0.666666666666667)
     & + gby(i,j+2,k)*(-0.0833333333333333)
     & )*idx
        d_Bu(3,2) = (
     & + gby(i,j,k-2)*(0.0833333333333333)
     & + gby(i,j,k-1)*(-0.666666666666667)
     & + gby(i,j,k+1)*(0.666666666666667)
     & + gby(i,j,k+2)*(-0.0833333333333333)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_Bu(1,2) = (
     & + gby(i-1,j,k)*(-0.25)
     & + gby(i  ,j,k)*(-0.833333333333333)
     & + gby(i+1,j,k)*(1.5)
     & + gby(i+2,j,k)*(-0.5)
     & + gby(i+3,j,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Bu(1,2) = (
     & + gby(i-3,j,k)*(-0.0833333333333333)
     & + gby(i-2,j,k)*(0.5)
     & + gby(i-1,j,k)*(-1.5)
     & + gby(i,j,k)*(0.833333333333333)
     & + gby(i+1,j,k)*(0.25)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_Bu(2,2) = (
     & + gby(i,j-1,k)*(-0.25)
     & + gby(i,j,k)*(-0.833333333333333)
     & + gby(i,j+1,k)*(1.5)
     & + gby(i,j+2,k)*(-0.5)
     & + gby(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Bu(2,2) = (
     & + gby(i,j-3,k)*(-0.0833333333333333)
     & + gby(i,j-2,k)*(0.5)
     & + gby(i,j-1,k)*(-1.5)
     & + gby(i,j,k)*(0.833333333333333)
     & + gby(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_Bu(3,2) = (
     & + gby(i,j,k-1)*(-0.25)
     & + gby(i,j,k)*(-0.833333333333333)
     & + gby(i,j,k+1)*(1.5)
     & + gby(i,j,k+2)*(-0.5)
     & + gby(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Bu(3,2) = (
     & + gby(i,j,k-3)*(-0.0833333333333333)
     & + gby(i,j,k-2)*(0.5)
     & + gby(i,j,k-1)*(-1.5)
     & + gby(i,j,k)*(0.833333333333333)
     & + gby(i,j,k+1)*(0.25)
     & )*idx
        end if
        Bu(3) = gbz(i,j,k)
        d_Bu(1,3) = (
     & + gbz(i-2,j,k)*(0.0833333333333333)
     & + gbz(i-1,j,k)*(-0.666666666666667)
     & + gbz(i+1,j,k)*(0.666666666666667)
     & + gbz(i+2,j,k)*(-0.0833333333333333)
     & )*idx
        d_Bu(2,3) = (
     & + gbz(i,j-2,k)*(0.0833333333333333)
     & + gbz(i,j-1,k)*(-0.666666666666667)
     & + gbz(i,j+1,k)*(0.666666666666667)
     & + gbz(i,j+2,k)*(-0.0833333333333333)
     & )*idx
        d_Bu(3,3) = (
     & + gbz(i,j,k-2)*(0.0833333333333333)
     & + gbz(i,j,k-1)*(-0.666666666666667)
     & + gbz(i,j,k+1)*(0.666666666666667)
     & + gbz(i,j,k+2)*(-0.0833333333333333)
     & )*idx
        if (shiftx(i,j,k) .ge. 0.0d0) then
        adv_d_Bu(1,3) = (
     & + gbz(i-1,j,k)*(-0.25)
     & + gbz(i  ,j,k)*(-0.833333333333333)
     & + gbz(i+1,j,k)*(1.5)
     & + gbz(i+2,j,k)*(-0.5)
     & + gbz(i+3,j,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Bu(1,3) = (
     & + gbz(i-3,j,k)*(-0.0833333333333333)
     & + gbz(i-2,j,k)*(0.5)
     & + gbz(i-1,j,k)*(-1.5)
     & + gbz(i,j,k)*(0.833333333333333)
     & + gbz(i+1,j,k)*(0.25)
     & )*idx
        end if
        if (shifty(i,j,k) .ge. 0.0d0) then
        adv_d_Bu(2,3) = (
     & + gbz(i,j-1,k)*(-0.25)
     & + gbz(i,j,k)*(-0.833333333333333)
     & + gbz(i,j+1,k)*(1.5)
     & + gbz(i,j+2,k)*(-0.5)
     & + gbz(i,j+3,k)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Bu(2,3) = (
     & + gbz(i,j-3,k)*(-0.0833333333333333)
     & + gbz(i,j-2,k)*(0.5)
     & + gbz(i,j-1,k)*(-1.5)
     & + gbz(i,j,k)*(0.833333333333333)
     & + gbz(i,j+1,k)*(0.25)
     & )*idx
        end if
        if (shiftz(i,j,k) .ge. 0.0d0) then
        adv_d_Bu(3,3) = (
     & + gbz(i,j,k-1)*(-0.25)
     & + gbz(i,j,k)*(-0.833333333333333)
     & + gbz(i,j,k+1)*(1.5)
     & + gbz(i,j,k+2)*(-0.5)
     & + gbz(i,j,k+3)*(0.0833333333333333)
     & )*idx
        else
        adv_d_Bu(3,3) = (
     & + gbz(i,j,k-3)*(-0.0833333333333333)
     & + gbz(i,j,k-2)*(0.5)
     & + gbz(i,j,k-1)*(-1.5)
     & + gbz(i,j,k)*(0.833333333333333)
     & + gbz(i,j,k+1)*(0.25)
     & )*idx
        end if
